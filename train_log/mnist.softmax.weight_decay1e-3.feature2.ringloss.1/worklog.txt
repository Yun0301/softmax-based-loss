Model(
  (backbone): Sequential(
    (0): Conv2d(1, 16, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3))
    (1): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (2): ReLU()
    (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (5): ReLU()
    (6): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (7): ReLU()
    (8): AvgPool2d(kernel_size=3, stride=3, padding=0)
  )
  (feature): Linear(in_features=64, out_features=2, bias=True)
  (pred): Linear(in_features=2, out_features=10, bias=False)
)
Epoch 1/40
----------
0.9990000128746033
step: 0, ce loss: 2.3001, ringloss:0.9185, loss:3.2186, train acc: 0.0938
0.9807385802268982
step: 100, ce loss: 2.3203, ringloss:0.0262, loss:2.3465, train acc: 0.1250
0.9787455797195435
step: 200, ce loss: 2.1502, ringloss:0.0542, loss:2.2044, train acc: 0.1875
0.9902369976043701
step: 300, ce loss: 2.0008, ringloss:0.0859, loss:2.0866, train acc: 0.2344
1.0134143829345703
step: 400, ce loss: 1.8840, ringloss:0.0522, loss:1.9362, train acc: 0.2500
1.0468674898147583
step: 500, ce loss: 1.8088, ringloss:0.0789, loss:1.8878, train acc: 0.2812
1.083885908126831
step: 600, ce loss: 1.7279, ringloss:0.0926, loss:1.8205, train acc: 0.3750
1.1258659362792969
step: 700, ce loss: 1.6445, ringloss:0.0447, loss:1.6893, train acc: 0.4531
1.1711488962173462
step: 800, ce loss: 1.6210, ringloss:0.0645, loss:1.6855, train acc: 0.5156
1.2167813777923584
step: 900, ce loss: 1.4930, ringloss:0.0764, loss:1.5695, train acc: 0.4219
Loss is:1.9025/0.0645, Train Accuracy is:28.07%, Test Accuracy is:48.14%, {'epoch': 1, 'accuracy': 0.4814}
0.0000, 0.1915, 0.0586, 0.2605, 0.0928, 0.5667, 0.7029, 0.2919, 0.0000, 0.6722
0.0000, 0.9551, 0.3324, 0.7861, 0.2281, 0.4070, 0.9259, 0.7481, 0.0000, 0.3469
Epoch 2/40
----------
1.2355307340621948
step: 0, ce loss: 1.5118, ringloss:0.0561, loss:1.5679, train acc: 0.4688
1.2847434282302856
step: 100, ce loss: 1.4929, ringloss:0.0959, loss:1.5888, train acc: 0.4531
1.3326681852340698
step: 200, ce loss: 1.4048, ringloss:0.0742, loss:1.4790, train acc: 0.4844
1.3793257474899292
step: 300, ce loss: 1.3074, ringloss:0.0641, loss:1.3715, train acc: 0.5000
1.428166151046753
step: 400, ce loss: 1.2882, ringloss:0.0887, loss:1.3769, train acc: 0.5312
1.4738315343856812
step: 500, ce loss: 1.2031, ringloss:0.1094, loss:1.3125, train acc: 0.5625
1.517665147781372
step: 600, ce loss: 1.0957, ringloss:0.0605, loss:1.1562, train acc: 0.6250
1.5615336894989014
step: 700, ce loss: 1.2294, ringloss:0.1513, loss:1.3807, train acc: 0.6719
1.5997661352157593
step: 800, ce loss: 1.1163, ringloss:0.1043, loss:1.2206, train acc: 0.6562
1.6388143301010132
step: 900, ce loss: 1.0873, ringloss:0.1216, loss:1.2089, train acc: 0.5625
Loss is:1.2832/0.0987, Train Accuracy is:58.42%, Test Accuracy is:72.59%, {'epoch': 2, 'accuracy': 0.7259}
0.1704, 0.9662, 0.6287, 0.8589, 0.6580, 0.3212, 0.9069, 0.7834, 0.2092, 0.2409
0.6480, 0.9824, 0.8430, 0.9277, 0.8625, 0.4888, 0.8967, 0.9397, 0.6099, 0.0000
Epoch 3/40
----------
1.6539721488952637
step: 0, ce loss: 1.0092, ringloss:0.1404, loss:1.1497, train acc: 0.8125
1.6918989419937134
step: 100, ce loss: 0.9460, ringloss:0.0952, loss:1.0411, train acc: 0.7969
1.7314664125442505
step: 200, ce loss: 0.9641, ringloss:0.0788, loss:1.0429, train acc: 0.8125
1.7691081762313843
step: 300, ce loss: 0.9097, ringloss:0.1166, loss:1.0263, train acc: 0.8125
1.8052632808685303
step: 400, ce loss: 0.9516, ringloss:0.0744, loss:1.0260, train acc: 0.7812
1.8402177095413208
step: 500, ce loss: 0.8572, ringloss:0.0741, loss:0.9313, train acc: 0.7656
1.8753454685211182
step: 600, ce loss: 0.8496, ringloss:0.0846, loss:0.9342, train acc: 0.8906
1.9098221063613892
step: 700, ce loss: 0.8970, ringloss:0.1038, loss:1.0008, train acc: 0.7656
1.9427045583724976
step: 800, ce loss: 0.8281, ringloss:0.1297, loss:0.9578, train acc: 0.8281
1.9723669290542603
step: 900, ce loss: 0.7515, ringloss:0.1151, loss:0.8666, train acc: 0.9062
Loss is:0.9496/0.1129, Train Accuracy is:78.23%, Test Accuracy is:81.89%, {'epoch': 3, 'accuracy': 0.8189}
0.8386, 0.9791, 0.8374, 0.8984, 0.8682, 0.7746, 0.9348, 0.9354, 0.7153, 0.0047
0.9378, 0.9903, 0.8731, 0.9287, 0.8890, 0.8722, 0.9415, 0.9416, 0.7947, 0.0119
Epoch 4/40
----------
1.9845385551452637
step: 0, ce loss: 0.8744, ringloss:0.1238, loss:0.9981, train acc: 0.8125
2.0156338214874268
step: 100, ce loss: 0.7873, ringloss:0.0965, loss:0.8838, train acc: 0.8906
2.047684669494629
step: 200, ce loss: 0.7972, ringloss:0.1090, loss:0.9062, train acc: 0.8438
2.0763063430786133
step: 300, ce loss: 0.7710, ringloss:0.0816, loss:0.8526, train acc: 0.8438
2.1069345474243164
step: 400, ce loss: 0.7740, ringloss:0.1078, loss:0.8818, train acc: 0.8750
2.1343746185302734
step: 500, ce loss: 0.6690, ringloss:0.1210, loss:0.7899, train acc: 0.8750
2.1609766483306885
step: 600, ce loss: 0.6832, ringloss:0.0704, loss:0.7536, train acc: 0.9375
2.188958168029785
step: 700, ce loss: 0.6907, ringloss:0.1089, loss:0.7996, train acc: 0.8594
2.2176554203033447
step: 800, ce loss: 0.7506, ringloss:0.1065, loss:0.8572, train acc: 0.8594
2.2434868812561035
step: 900, ce loss: 0.6909, ringloss:0.1226, loss:0.8135, train acc: 0.8125
Loss is:0.7753/0.1095, Train Accuracy is:84.60%, Test Accuracy is:89.99%, {'epoch': 4, 'accuracy': 0.8999}
0.9451, 0.9818, 0.8619, 0.9114, 0.9115, 0.8974, 0.9491, 0.9114, 0.8434, 0.2303
0.9602, 0.9868, 0.8585, 0.9178, 0.9012, 0.9339, 0.9259, 0.8911, 0.8634, 0.7562
Epoch 5/40
----------
2.251978874206543
step: 0, ce loss: 0.6973, ringloss:0.1629, loss:0.8601, train acc: 0.8594
2.2792558670043945
step: 100, ce loss: 0.6973, ringloss:0.1011, loss:0.7984, train acc: 0.8594
2.3064215183258057
step: 200, ce loss: 0.5513, ringloss:0.1347, loss:0.6859, train acc: 0.9062
2.328949213027954
step: 300, ce loss: 0.7070, ringloss:0.1899, loss:0.8969, train acc: 0.8438
2.3517603874206543
step: 400, ce loss: 0.6555, ringloss:0.1248, loss:0.7804, train acc: 0.9062
2.376516819000244
step: 500, ce loss: 0.6288, ringloss:0.1052, loss:0.7341, train acc: 0.9531
2.3984549045562744
step: 600, ce loss: 0.6233, ringloss:0.0872, loss:0.7106, train acc: 0.8906
2.4195632934570312
step: 700, ce loss: 0.6433, ringloss:0.1300, loss:0.7733, train acc: 0.8750
2.4413399696350098
step: 800, ce loss: 0.5775, ringloss:0.0886, loss:0.6660, train acc: 0.9531
2.4629852771759033
step: 900, ce loss: 0.6099, ringloss:0.1121, loss:0.7220, train acc: 0.9219
Loss is:0.6620/0.1141, Train Accuracy is:90.71%, Test Accuracy is:91.91%, {'epoch': 5, 'accuracy': 0.9191}
0.9607, 0.9773, 0.8805, 0.9215, 0.9242, 0.9151, 0.9535, 0.9098, 0.8703, 0.7494
0.9694, 0.9877, 0.8828, 0.9386, 0.9114, 0.9170, 0.9384, 0.9368, 0.8573, 0.8434
Epoch 6/40
----------
2.4719130992889404
step: 0, ce loss: 0.6655, ringloss:0.0770, loss:0.7425, train acc: 0.9219
2.4954605102539062
step: 100, ce loss: 0.8252, ringloss:0.1319, loss:0.9570, train acc: 0.8594
2.5200436115264893
step: 200, ce loss: 0.6628, ringloss:0.1314, loss:0.7943, train acc: 0.9062
2.541595220565796
step: 300, ce loss: 0.5508, ringloss:0.0812, loss:0.6320, train acc: 0.9375
2.562413454055786
step: 400, ce loss: 0.8623, ringloss:0.1285, loss:0.9908, train acc: 0.8594
2.583280324935913
step: 500, ce loss: 0.4890, ringloss:0.1375, loss:0.6265, train acc: 0.8906
2.603776454925537
step: 600, ce loss: 0.5713, ringloss:0.1390, loss:0.7103, train acc: 0.9219
2.62575101852417
step: 700, ce loss: 0.5330, ringloss:0.1644, loss:0.6975, train acc: 0.9531
2.6463875770568848
step: 800, ce loss: 0.4928, ringloss:0.1024, loss:0.5952, train acc: 0.9688
2.6667001247406006
step: 900, ce loss: 0.5520, ringloss:0.1188, loss:0.6708, train acc: 0.9375
Loss is:0.5710/0.1163, Train Accuracy is:92.94%, Test Accuracy is:93.44%, {'epoch': 6, 'accuracy': 0.9344}
0.9654, 0.9766, 0.8991, 0.9300, 0.9351, 0.9268, 0.9615, 0.9301, 0.8785, 0.8838
0.9796, 0.9771, 0.9205, 0.9554, 0.9185, 0.9249, 0.9614, 0.9144, 0.9025, 0.8850
Epoch 7/40
----------
2.67440128326416
step: 0, ce loss: 0.5376, ringloss:0.1870, loss:0.7245, train acc: 0.9375
2.692652463912964
step: 100, ce loss: 0.5719, ringloss:0.0819, loss:0.6537, train acc: 0.9531
2.713299512863159
step: 200, ce loss: 0.4741, ringloss:0.1402, loss:0.6143, train acc: 0.9219
2.7337379455566406
step: 300, ce loss: 0.6000, ringloss:0.1065, loss:0.7065, train acc: 0.9531
2.7524735927581787
step: 400, ce loss: 0.5738, ringloss:0.1248, loss:0.6986, train acc: 0.9219
2.7710089683532715
step: 500, ce loss: 0.5753, ringloss:0.1208, loss:0.6962, train acc: 0.9375
2.788278341293335
step: 600, ce loss: 0.4393, ringloss:0.1164, loss:0.5557, train acc: 0.9375
2.805079460144043
step: 700, ce loss: 0.4032, ringloss:0.1247, loss:0.5279, train acc: 1.0000
2.822511911392212
step: 800, ce loss: 0.3769, ringloss:0.0719, loss:0.4488, train acc: 0.9688
2.838472604751587
step: 900, ce loss: 0.4843, ringloss:0.1359, loss:0.6203, train acc: 0.9375
Loss is:0.4999/0.1225, Train Accuracy is:93.90%, Test Accuracy is:93.59%, {'epoch': 7, 'accuracy': 0.9359}
0.9710, 0.9773, 0.9147, 0.9410, 0.9449, 0.9314, 0.9679, 0.9437, 0.8862, 0.9057
0.9612, 0.9833, 0.9390, 0.9228, 0.9358, 0.8800, 0.9426, 0.9397, 0.9138, 0.9286
Epoch 8/40
----------
2.844524621963501
step: 0, ce loss: 0.3903, ringloss:0.1418, loss:0.5321, train acc: 0.9844
2.8608925342559814
step: 100, ce loss: 0.4468, ringloss:0.1172, loss:0.5640, train acc: 0.9219
2.8791770935058594
step: 200, ce loss: 0.7279, ringloss:0.1536, loss:0.8815, train acc: 0.8906
2.8967487812042236
step: 300, ce loss: 0.5139, ringloss:0.1120, loss:0.6258, train acc: 0.9219
2.912797212600708
step: 400, ce loss: 0.4119, ringloss:0.0843, loss:0.4961, train acc: 0.9844
2.9292826652526855
step: 500, ce loss: 0.4039, ringloss:0.1333, loss:0.5372, train acc: 0.9219
2.9434986114501953
step: 600, ce loss: 0.3601, ringloss:0.1168, loss:0.4769, train acc: 0.9688
2.9594054222106934
step: 700, ce loss: 0.8093, ringloss:0.1256, loss:0.9349, train acc: 0.9219
2.9704842567443848
step: 800, ce loss: 0.3280, ringloss:0.0791, loss:0.4071, train acc: 0.9844
2.9845845699310303
step: 900, ce loss: 0.3712, ringloss:0.1261, loss:0.4973, train acc: 0.9375
Loss is:0.4441/0.1241, Train Accuracy is:94.40%, Test Accuracy is:94.47%, {'epoch': 8, 'accuracy': 0.9447}
0.9733, 0.9760, 0.9245, 0.9419, 0.9454, 0.9391, 0.9676, 0.9551, 0.8959, 0.9158
0.9847, 0.9718, 0.9293, 0.9327, 0.9582, 0.9294, 0.9666, 0.9494, 0.9014, 0.9197
Epoch 9/40
----------
2.9893176555633545
step: 0, ce loss: 0.3713, ringloss:0.1553, loss:0.5266, train acc: 0.9375
3.0058822631835938
step: 100, ce loss: 0.2957, ringloss:0.1448, loss:0.4405, train acc: 0.9688
3.021078109741211
step: 200, ce loss: 0.3164, ringloss:0.0863, loss:0.4026, train acc: 0.9688
3.0362143516540527
step: 300, ce loss: 0.3624, ringloss:0.1312, loss:0.4936, train acc: 0.9688
3.0500757694244385
step: 400, ce loss: 0.3678, ringloss:0.1184, loss:0.4861, train acc: 0.9531
3.061415672302246
step: 500, ce loss: 0.6058, ringloss:0.1226, loss:0.7284, train acc: 0.9531
3.074429512023926
step: 600, ce loss: 0.4446, ringloss:0.1283, loss:0.5729, train acc: 0.9219
3.0869569778442383
step: 700, ce loss: 0.3411, ringloss:0.1002, loss:0.4413, train acc: 0.9688
3.098453998565674
step: 800, ce loss: 0.3581, ringloss:0.1374, loss:0.4954, train acc: 0.9688
3.1097054481506348
step: 900, ce loss: 0.4588, ringloss:0.2207, loss:0.6795, train acc: 0.9375
Loss is:0.3988/0.1257, Train Accuracy is:95.01%, Test Accuracy is:94.44%, {'epoch': 8, 'accuracy': 0.9447}
0.9759, 0.9776, 0.9319, 0.9472, 0.9531, 0.9441, 0.9696, 0.9575, 0.9087, 0.9306
0.9724, 0.9806, 0.9176, 0.9396, 0.9593, 0.9372, 0.9593, 0.9621, 0.8901, 0.9207
Epoch 10/40
----------
3.113717555999756
step: 0, ce loss: 0.2872, ringloss:0.1220, loss:0.4092, train acc: 0.9688
3.12589430809021
step: 100, ce loss: 0.2587, ringloss:0.1049, loss:0.3636, train acc: 0.9844
3.1390607357025146
step: 200, ce loss: 0.2602, ringloss:0.1179, loss:0.3781, train acc: 1.0000
3.15146803855896
step: 300, ce loss: 0.3032, ringloss:0.0951, loss:0.3984, train acc: 0.9688
3.1622791290283203
step: 400, ce loss: 0.2934, ringloss:0.1370, loss:0.4304, train acc: 0.9688
3.1714885234832764
step: 500, ce loss: 0.3353, ringloss:0.0967, loss:0.4320, train acc: 0.9688
3.180849075317383
step: 600, ce loss: 0.2734, ringloss:0.1201, loss:0.3935, train acc: 0.9688
3.1923983097076416
step: 700, ce loss: 0.3805, ringloss:0.1226, loss:0.5031, train acc: 0.9062
3.202224016189575
step: 800, ce loss: 0.5437, ringloss:0.1186, loss:0.6623, train acc: 0.9375
3.2132534980773926
step: 900, ce loss: 0.3325, ringloss:0.1514, loss:0.4838, train acc: 0.9219
Loss is:0.3638/0.1264, Train Accuracy is:95.34%, Test Accuracy is:94.56%, {'epoch': 10, 'accuracy': 0.9456}
0.9802, 0.9773, 0.9414, 0.9503, 0.9550, 0.9463, 0.9706, 0.9579, 0.9181, 0.9323
0.9786, 0.9815, 0.9118, 0.9337, 0.9654, 0.9361, 0.9541, 0.9611, 0.8973, 0.9316
Epoch 11/40
----------
3.2172906398773193
step: 0, ce loss: 0.4244, ringloss:0.1855, loss:0.6099, train acc: 0.9375
3.2303194999694824
step: 100, ce loss: 0.2483, ringloss:0.0961, loss:0.3444, train acc: 0.9844
3.24225115776062
step: 200, ce loss: 0.2629, ringloss:0.1687, loss:0.4316, train acc: 0.9688
3.2511653900146484
step: 300, ce loss: 0.2298, ringloss:0.0878, loss:0.3176, train acc: 0.9844
3.260497570037842
step: 400, ce loss: 0.2996, ringloss:0.1216, loss:0.4212, train acc: 0.9375
3.2712655067443848
step: 500, ce loss: 0.5104, ringloss:0.1767, loss:0.6871, train acc: 0.8750
3.2798233032226562
step: 600, ce loss: 0.4304, ringloss:0.1528, loss:0.5832, train acc: 0.9219
3.2864673137664795
step: 700, ce loss: 0.3603, ringloss:0.1226, loss:0.4829, train acc: 0.9375
3.294313907623291
step: 800, ce loss: 0.5439, ringloss:0.2168, loss:0.7606, train acc: 0.9062
3.3008177280426025
step: 900, ce loss: 0.2184, ringloss:0.1082, loss:0.3265, train acc: 1.0000
Loss is:0.3351/0.1271, Train Accuracy is:95.60%, Test Accuracy is:95.21%, {'epoch': 11, 'accuracy': 0.9521}
0.9811, 0.9780, 0.9402, 0.9540, 0.9558, 0.9469, 0.9735, 0.9628, 0.9234, 0.9403
0.9714, 0.9868, 0.9486, 0.9396, 0.9542, 0.9529, 0.9426, 0.9562, 0.9189, 0.9445
Epoch 12/40
----------
3.304673433303833
step: 0, ce loss: 0.2281, ringloss:0.0927, loss:0.3208, train acc: 0.9844
3.314342498779297
step: 100, ce loss: 0.2357, ringloss:0.1000, loss:0.3357, train acc: 0.9844
3.3252265453338623
step: 200, ce loss: 0.6716, ringloss:0.1889, loss:0.8605, train acc: 0.9375
3.336076021194458
step: 300, ce loss: 0.3475, ringloss:0.1276, loss:0.4751, train acc: 0.9062
3.343984842300415
step: 400, ce loss: 0.4719, ringloss:0.1283, loss:0.6002, train acc: 0.9219
3.3515372276306152
step: 500, ce loss: 0.3858, ringloss:0.1388, loss:0.5246, train acc: 0.9688
3.36008358001709
step: 600, ce loss: 0.2363, ringloss:0.1212, loss:0.3576, train acc: 0.9844
3.3664159774780273
step: 700, ce loss: 0.3130, ringloss:0.0897, loss:0.4027, train acc: 0.9688
3.372180461883545
step: 800, ce loss: 0.3230, ringloss:0.1813, loss:0.5042, train acc: 0.9062
3.3798396587371826
step: 900, ce loss: 0.2195, ringloss:0.0550, loss:0.2744, train acc: 0.9531
Loss is:0.3100/0.1241, Train Accuracy is:95.78%, Test Accuracy is:95.18%, {'epoch': 11, 'accuracy': 0.9521}
0.9797, 0.9800, 0.9434, 0.9550, 0.9593, 0.9493, 0.9736, 0.9607, 0.9306, 0.9423
0.9816, 0.9744, 0.9409, 0.9614, 0.9745, 0.9271, 0.9687, 0.9572, 0.9045, 0.9227
Epoch 13/40
----------
3.383096933364868
step: 0, ce loss: 0.3868, ringloss:0.1307, loss:0.5175, train acc: 0.9062
3.3924851417541504
step: 100, ce loss: 0.3646, ringloss:0.1283, loss:0.4929, train acc: 0.9219
3.4006073474884033
step: 200, ce loss: 0.3244, ringloss:0.1184, loss:0.4428, train acc: 0.9844
3.4089393615722656
step: 300, ce loss: 0.2406, ringloss:0.0808, loss:0.3215, train acc: 0.9688
3.416269540786743
step: 400, ce loss: 0.3672, ringloss:0.1085, loss:0.4757, train acc: 0.9688
3.424194574356079
step: 500, ce loss: 0.2370, ringloss:0.1509, loss:0.3878, train acc: 0.9688
3.4311821460723877
step: 600, ce loss: 0.5948, ringloss:0.0952, loss:0.6901, train acc: 0.9531
3.4365057945251465
step: 700, ce loss: 0.2125, ringloss:0.1169, loss:0.3293, train acc: 0.9688
3.441767930984497
step: 800, ce loss: 0.3937, ringloss:0.1573, loss:0.5509, train acc: 0.9688
3.4478511810302734
step: 900, ce loss: 0.5033, ringloss:0.0794, loss:0.5827, train acc: 0.9688
Loss is:0.2934/0.1212, Train Accuracy is:96.07%, Test Accuracy is:95.38%, {'epoch': 13, 'accuracy': 0.9538}
0.9806, 0.9794, 0.9483, 0.9566, 0.9642, 0.9496, 0.9763, 0.9646, 0.9373, 0.9462
0.9857, 0.9683, 0.9428, 0.9287, 0.9338, 0.9608, 0.9781, 0.9611, 0.9271, 0.9514
Epoch 14/40
----------
3.4503889083862305
step: 0, ce loss: 0.2575, ringloss:0.1487, loss:0.4062, train acc: 0.9688
3.4576241970062256
step: 100, ce loss: 0.1975, ringloss:0.1830, loss:0.3805, train acc: 0.9688
3.4672560691833496
step: 200, ce loss: 0.3141, ringloss:0.1253, loss:0.4395, train acc: 0.9688
3.4733543395996094
step: 300, ce loss: 0.3666, ringloss:0.1366, loss:0.5032, train acc: 0.9531
3.4805259704589844
step: 400, ce loss: 0.2452, ringloss:0.1213, loss:0.3665, train acc: 0.9531
3.487039566040039
step: 500, ce loss: 0.1778, ringloss:0.1066, loss:0.2844, train acc: 0.9844
3.4919490814208984
step: 600, ce loss: 0.3875, ringloss:0.1476, loss:0.5351, train acc: 0.9219
3.4981627464294434
step: 700, ce loss: 0.2773, ringloss:0.2289, loss:0.5062, train acc: 0.9219
3.5043983459472656
step: 800, ce loss: 0.2654, ringloss:0.0797, loss:0.3451, train acc: 0.9531
3.5077197551727295
step: 900, ce loss: 0.2595, ringloss:0.1686, loss:0.4281, train acc: 0.9531
Loss is:0.2721/0.1228, Train Accuracy is:96.30%, Test Accuracy is:95.95%, {'epoch': 14, 'accuracy': 0.9595}
0.9831, 0.9803, 0.9512, 0.9597, 0.9622, 0.9587, 0.9784, 0.9657, 0.9381, 0.9499
0.9816, 0.9824, 0.9399, 0.9683, 0.9430, 0.9496, 0.9697, 0.9679, 0.9343, 0.9544
Epoch 15/40
----------
3.510601758956909
step: 0, ce loss: 0.2854, ringloss:0.0742, loss:0.3596, train acc: 0.9688
3.5159168243408203
step: 100, ce loss: 0.4016, ringloss:0.1373, loss:0.5389, train acc: 0.9375
3.522268056869507
step: 200, ce loss: 0.1980, ringloss:0.0984, loss:0.2964, train acc: 0.9844
3.5279500484466553
step: 300, ce loss: 0.1950, ringloss:0.0784, loss:0.2734, train acc: 0.9844
3.535461902618408
step: 400, ce loss: 0.1860, ringloss:0.0972, loss:0.2832, train acc: 0.9688
3.540619373321533
step: 500, ce loss: 0.1593, ringloss:0.0728, loss:0.2321, train acc: 1.0000
3.5468575954437256
step: 600, ce loss: 0.1568, ringloss:0.0931, loss:0.2498, train acc: 1.0000
3.5529098510742188
step: 700, ce loss: 0.2770, ringloss:0.0808, loss:0.3578, train acc: 0.9844
3.557385206222534
step: 800, ce loss: 0.1655, ringloss:0.0875, loss:0.2530, train acc: 0.9688
3.5597379207611084
step: 900, ce loss: 0.1629, ringloss:0.1036, loss:0.2665, train acc: 0.9688
Loss is:0.2616/0.1205, Train Accuracy is:96.32%, Test Accuracy is:95.03%, {'epoch': 14, 'accuracy': 0.9595}
0.9835, 0.9778, 0.9510, 0.9599, 0.9632, 0.9576, 0.9785, 0.9681, 0.9392, 0.9509
0.9847, 0.9806, 0.9370, 0.9723, 0.9705, 0.9395, 0.9645, 0.9562, 0.8840, 0.9088
Epoch 16/40
----------
3.5618038177490234
step: 0, ce loss: 0.5431, ringloss:0.1377, loss:0.6807, train acc: 0.9688
3.5684306621551514
step: 100, ce loss: 0.1378, ringloss:0.0921, loss:0.2299, train acc: 1.0000
3.5728135108947754
step: 200, ce loss: 0.2153, ringloss:0.1295, loss:0.3448, train acc: 0.9688
3.579555034637451
step: 300, ce loss: 0.1943, ringloss:0.1016, loss:0.2959, train acc: 0.9688
3.584531307220459
step: 400, ce loss: 0.2600, ringloss:0.1825, loss:0.4425, train acc: 0.9688
3.5895893573760986
step: 500, ce loss: 0.1965, ringloss:0.0729, loss:0.2694, train acc: 0.9375
3.5960071086883545
step: 600, ce loss: 0.1945, ringloss:0.1104, loss:0.3049, train acc: 0.9688
3.600168228149414
step: 700, ce loss: 0.1318, ringloss:0.1076, loss:0.2394, train acc: 1.0000
3.6044130325317383
step: 800, ce loss: 0.2198, ringloss:0.0951, loss:0.3149, train acc: 0.9531
3.6075074672698975
step: 900, ce loss: 0.1249, ringloss:0.1031, loss:0.2281, train acc: 1.0000
Loss is:0.2472/0.1186, Train Accuracy is:96.52%, Test Accuracy is:96.00%, {'epoch': 16, 'accuracy': 0.96}
0.9835, 0.9800, 0.9533, 0.9633, 0.9678, 0.9594, 0.9757, 0.9679, 0.9429, 0.9553
0.9796, 0.9780, 0.9545, 0.9574, 0.9674, 0.9350, 0.9729, 0.9621, 0.9405, 0.9485
Epoch 17/40
----------
3.60870623588562
step: 0, ce loss: 0.1495, ringloss:0.0917, loss:0.2412, train acc: 0.9844
3.6146810054779053
step: 100, ce loss: 0.3077, ringloss:0.1550, loss:0.4627, train acc: 0.9375
3.619939088821411
step: 200, ce loss: 0.1820, ringloss:0.0680, loss:0.2500, train acc: 0.9688
3.6243748664855957
step: 300, ce loss: 0.1397, ringloss:0.1170, loss:0.2567, train acc: 1.0000
3.630340814590454
step: 400, ce loss: 0.1912, ringloss:0.1405, loss:0.3316, train acc: 0.9844
3.635035276412964
step: 500, ce loss: 0.5407, ringloss:0.1853, loss:0.7259, train acc: 0.9375
3.6398868560791016
step: 600, ce loss: 0.1530, ringloss:0.0988, loss:0.2517, train acc: 0.9844
3.6429638862609863
step: 700, ce loss: 0.1663, ringloss:0.0897, loss:0.2561, train acc: 0.9688
3.6474225521087646
step: 800, ce loss: 0.2347, ringloss:0.1526, loss:0.3873, train acc: 0.9375
3.6507506370544434
step: 900, ce loss: 0.1419, ringloss:0.0848, loss:0.2268, train acc: 0.9844
Loss is:0.2354/0.1184, Train Accuracy is:96.67%, Test Accuracy is:95.53%, {'epoch': 16, 'accuracy': 0.96}
0.9843, 0.9783, 0.9585, 0.9641, 0.9666, 0.9613, 0.9819, 0.9713, 0.9415, 0.9571
0.9786, 0.9859, 0.9496, 0.9515, 0.9246, 0.9709, 0.9447, 0.9708, 0.9240, 0.9485
Epoch 18/40
----------
3.652240037918091
step: 0, ce loss: 0.1464, ringloss:0.0726, loss:0.2190, train acc: 0.9844
3.657853603363037
step: 100, ce loss: 0.1394, ringloss:0.0744, loss:0.2138, train acc: 0.9844
3.6605260372161865
step: 200, ce loss: 0.1848, ringloss:0.1317, loss:0.3165, train acc: 0.9688
3.664332628250122
step: 300, ce loss: 0.1715, ringloss:0.1153, loss:0.2868, train acc: 0.9844
3.6689600944519043
step: 400, ce loss: 0.4976, ringloss:0.1314, loss:0.6290, train acc: 0.9375
3.6736538410186768
step: 500, ce loss: 0.2450, ringloss:0.1423, loss:0.3872, train acc: 0.9531
3.678309679031372
step: 600, ce loss: 0.2298, ringloss:0.1271, loss:0.3569, train acc: 0.9688
3.6824538707733154
step: 700, ce loss: 0.1961, ringloss:0.1215, loss:0.3176, train acc: 0.9531
3.6838252544403076
step: 800, ce loss: 0.2676, ringloss:0.1118, loss:0.3795, train acc: 0.9375
3.6869163513183594
step: 900, ce loss: 0.1781, ringloss:0.0992, loss:0.2773, train acc: 0.9688
Loss is:0.2276/0.1185, Train Accuracy is:96.70%, Test Accuracy is:96.15%, {'epoch': 18, 'accuracy': 0.9615}
0.9838, 0.9807, 0.9538, 0.9644, 0.9702, 0.9589, 0.9782, 0.9721, 0.9482, 0.9566
0.9827, 0.9815, 0.9535, 0.9446, 0.9796, 0.9563, 0.9656, 0.9689, 0.9425, 0.9376
Epoch 19/40
----------
3.689427375793457
step: 0, ce loss: 0.1314, ringloss:0.1188, loss:0.2502, train acc: 1.0000
3.69381046295166
step: 100, ce loss: 0.2469, ringloss:0.0780, loss:0.3249, train acc: 0.9375
3.698544979095459
step: 200, ce loss: 0.1420, ringloss:0.1316, loss:0.2736, train acc: 0.9844
3.701359748840332
step: 300, ce loss: 0.2432, ringloss:0.1073, loss:0.3505, train acc: 0.9844
3.7071731090545654
step: 400, ce loss: 0.1412, ringloss:0.1040, loss:0.2451, train acc: 1.0000
3.711268186569214
step: 500, ce loss: 0.2917, ringloss:0.1247, loss:0.4164, train acc: 0.9375
3.7153983116149902
step: 600, ce loss: 0.2090, ringloss:0.1137, loss:0.3227, train acc: 0.9688
3.718036651611328
step: 700, ce loss: 0.1299, ringloss:0.1453, loss:0.2752, train acc: 1.0000
3.721534013748169
step: 800, ce loss: 0.1253, ringloss:0.0698, loss:0.1951, train acc: 0.9844
3.7240610122680664
step: 900, ce loss: 0.2785, ringloss:0.0900, loss:0.3686, train acc: 0.9688
Loss is:0.2191/0.1142, Train Accuracy is:96.85%, Test Accuracy is:96.30%, {'epoch': 19, 'accuracy': 0.963}
0.9856, 0.9792, 0.9607, 0.9659, 0.9697, 0.9620, 0.9801, 0.9743, 0.9491, 0.9556
0.9888, 0.9753, 0.9506, 0.9663, 0.9664, 0.9473, 0.9708, 0.9650, 0.9487, 0.9485
Epoch 20/40
----------
3.7254810333251953
step: 0, ce loss: 0.1510, ringloss:0.1088, loss:0.2598, train acc: 0.9688
3.7288742065429688
step: 100, ce loss: 0.3408, ringloss:0.1069, loss:0.4477, train acc: 0.9688
3.7315855026245117
step: 200, ce loss: 0.3480, ringloss:0.1256, loss:0.4737, train acc: 0.9531
3.7369136810302734
step: 300, ce loss: 0.1895, ringloss:0.0824, loss:0.2719, train acc: 0.9688
3.7407007217407227
step: 400, ce loss: 0.1259, ringloss:0.0707, loss:0.1967, train acc: 1.0000
3.7468554973602295
step: 500, ce loss: 0.5370, ringloss:0.1139, loss:0.6509, train acc: 0.9688
3.750608205795288
step: 600, ce loss: 0.2933, ringloss:0.1046, loss:0.3979, train acc: 0.9688
3.755626678466797
step: 700, ce loss: 0.2115, ringloss:0.1997, loss:0.4112, train acc: 0.9531
3.7590067386627197
step: 800, ce loss: 0.2367, ringloss:0.1749, loss:0.4116, train acc: 0.9375
3.758742332458496
step: 900, ce loss: 0.1389, ringloss:0.0857, loss:0.2246, train acc: 0.9844
Loss is:0.2100/0.1123, Train Accuracy is:97.02%, Test Accuracy is:96.24%, {'epoch': 19, 'accuracy': 0.963}
0.9862, 0.9812, 0.9609, 0.9692, 0.9711, 0.9616, 0.9826, 0.9746, 0.9515, 0.9612
0.9796, 0.9815, 0.9554, 0.9594, 0.9613, 0.9372, 0.9760, 0.9660, 0.9507, 0.9524
Epoch 21/40
----------
3.7605814933776855
step: 0, ce loss: 0.1953, ringloss:0.1477, loss:0.3431, train acc: 0.9531
3.764131784439087
step: 100, ce loss: 0.1265, ringloss:0.1661, loss:0.2927, train acc: 0.9688
3.7668702602386475
step: 200, ce loss: 0.1447, ringloss:0.0850, loss:0.2297, train acc: 0.9844
3.7698025703430176
step: 300, ce loss: 0.1563, ringloss:0.0685, loss:0.2247, train acc: 0.9531
3.775045156478882
step: 400, ce loss: 0.2759, ringloss:0.1078, loss:0.3837, train acc: 0.9531
3.776627540588379
step: 500, ce loss: 0.1783, ringloss:0.0974, loss:0.2757, train acc: 0.9688
3.7814037799835205
step: 600, ce loss: 0.1215, ringloss:0.1219, loss:0.2434, train acc: 0.9844
3.786238193511963
step: 700, ce loss: 0.3484, ringloss:0.2037, loss:0.5521, train acc: 0.9375
3.788360595703125
step: 800, ce loss: 0.1122, ringloss:0.1184, loss:0.2306, train acc: 1.0000
3.790179491043091
step: 900, ce loss: 0.1883, ringloss:0.1049, loss:0.2932, train acc: 0.9688
Loss is:0.2086/0.1112, Train Accuracy is:97.02%, Test Accuracy is:95.87%, {'epoch': 19, 'accuracy': 0.963}
0.9851, 0.9840, 0.9597, 0.9675, 0.9712, 0.9657, 0.9807, 0.9724, 0.9521, 0.9607
0.9776, 0.9824, 0.9390, 0.9198, 0.9745, 0.9473, 0.9645, 0.9660, 0.9476, 0.9653
Epoch 22/40
----------
3.7901313304901123
step: 0, ce loss: 0.2038, ringloss:0.1092, loss:0.3130, train acc: 0.9688
3.7938930988311768
step: 100, ce loss: 0.1300, ringloss:0.0903, loss:0.2204, train acc: 0.9844
3.7987353801727295
step: 200, ce loss: 0.1351, ringloss:0.1066, loss:0.2417, train acc: 0.9844
3.801802158355713
step: 300, ce loss: 0.1510, ringloss:0.1417, loss:0.2928, train acc: 0.9844
3.8056178092956543
step: 400, ce loss: 0.1149, ringloss:0.0648, loss:0.1798, train acc: 1.0000
3.809455394744873
step: 500, ce loss: 0.1271, ringloss:0.1415, loss:0.2686, train acc: 0.9844
3.812215566635132
step: 600, ce loss: 0.1255, ringloss:0.1257, loss:0.2512, train acc: 1.0000
3.8169949054718018
step: 700, ce loss: 0.1089, ringloss:0.0592, loss:0.1681, train acc: 1.0000
3.8203091621398926
step: 800, ce loss: 0.0977, ringloss:0.0595, loss:0.1571, train acc: 1.0000
3.8226664066314697
step: 900, ce loss: 0.4762, ringloss:0.1224, loss:0.5986, train acc: 0.9531
Loss is:0.1956/0.1091, Train Accuracy is:97.14%, Test Accuracy is:96.05%, {'epoch': 19, 'accuracy': 0.963}
0.9863, 0.9835, 0.9621, 0.9677, 0.9731, 0.9651, 0.9818, 0.9751, 0.9532, 0.9635
0.9786, 0.9815, 0.9351, 0.9644, 0.9613, 0.9664, 0.9635, 0.9630, 0.9548, 0.9356
Epoch 23/40
----------
3.822929859161377
step: 0, ce loss: 0.1281, ringloss:0.1367, loss:0.2649, train acc: 0.9844
3.8260724544525146
step: 100, ce loss: 0.1373, ringloss:0.0818, loss:0.2191, train acc: 0.9688
3.8307597637176514
step: 200, ce loss: 0.2465, ringloss:0.1792, loss:0.4257, train acc: 0.9219
3.835787057876587
step: 300, ce loss: 0.1130, ringloss:0.0697, loss:0.1828, train acc: 1.0000
3.8386285305023193
step: 400, ce loss: 0.1464, ringloss:0.1474, loss:0.2937, train acc: 0.9688
3.8404808044433594
step: 500, ce loss: 0.2036, ringloss:0.1332, loss:0.3368, train acc: 0.9688
3.843214511871338
step: 600, ce loss: 0.1547, ringloss:0.1459, loss:0.3006, train acc: 0.9688
3.8455402851104736
step: 700, ce loss: 0.1576, ringloss:0.1163, loss:0.2739, train acc: 0.9688
3.848600387573242
step: 800, ce loss: 0.2190, ringloss:0.0920, loss:0.3110, train acc: 0.9531
3.8529858589172363
step: 900, ce loss: 0.1335, ringloss:0.0980, loss:0.2315, train acc: 0.9844
Loss is:0.1926/0.1081, Train Accuracy is:97.22%, Test Accuracy is:95.88%, {'epoch': 19, 'accuracy': 0.963}
0.9860, 0.9843, 0.9594, 0.9695, 0.9724, 0.9659, 0.9814, 0.9781, 0.9571, 0.9650
0.9908, 0.9859, 0.9438, 0.9554, 0.9644, 0.9484, 0.9739, 0.9708, 0.9014, 0.9485
Epoch 24/40
----------
3.8541171550750732
step: 0, ce loss: 0.3220, ringloss:0.1325, loss:0.4545, train acc: 0.9219
3.856210947036743
step: 100, ce loss: 0.1058, ringloss:0.0741, loss:0.1799, train acc: 1.0000
3.8589935302734375
step: 200, ce loss: 0.1861, ringloss:0.1053, loss:0.2914, train acc: 0.9688
3.8619377613067627
step: 300, ce loss: 0.1099, ringloss:0.1281, loss:0.2380, train acc: 1.0000
3.8652868270874023
step: 400, ce loss: 0.1483, ringloss:0.1564, loss:0.3047, train acc: 0.9844
3.8700203895568848
step: 500, ce loss: 0.1330, ringloss:0.1394, loss:0.2724, train acc: 0.9844
3.8708410263061523
step: 600, ce loss: 0.1102, ringloss:0.0842, loss:0.1944, train acc: 0.9844
3.873286724090576
step: 700, ce loss: 0.1767, ringloss:0.1180, loss:0.2947, train acc: 0.9688
3.8766584396362305
step: 800, ce loss: 0.6373, ringloss:0.1183, loss:0.7556, train acc: 0.9531
3.878243923187256
step: 900, ce loss: 0.2534, ringloss:0.1431, loss:0.3965, train acc: 0.9688
Loss is:0.1925/0.1084, Train Accuracy is:97.21%, Test Accuracy is:96.32%, {'epoch': 24, 'accuracy': 0.9632}
0.9870, 0.9847, 0.9632, 0.9702, 0.9721, 0.9673, 0.9828, 0.9754, 0.9551, 0.9612
0.9847, 0.9833, 0.9486, 0.9772, 0.9409, 0.9596, 0.9802, 0.9689, 0.9466, 0.9395
Epoch 25/40
----------
3.877840518951416
step: 0, ce loss: 0.3028, ringloss:0.1399, loss:0.4427, train acc: 0.9219
3.8810806274414062
step: 100, ce loss: 0.1342, ringloss:0.1092, loss:0.2434, train acc: 0.9844
3.8856379985809326
step: 200, ce loss: 0.1952, ringloss:0.1263, loss:0.3215, train acc: 0.9844
3.890177011489868
step: 300, ce loss: 0.1156, ringloss:0.0678, loss:0.1834, train acc: 0.9844
3.8962411880493164
step: 400, ce loss: 0.2134, ringloss:0.1540, loss:0.3674, train acc: 0.9688
3.8997185230255127
step: 500, ce loss: 0.2162, ringloss:0.1480, loss:0.3642, train acc: 0.9375
3.9030466079711914
step: 600, ce loss: 0.1028, ringloss:0.0806, loss:0.1835, train acc: 1.0000
3.904937982559204
step: 700, ce loss: 0.1060, ringloss:0.0904, loss:0.1964, train acc: 1.0000
3.9063775539398193
step: 800, ce loss: 0.0870, ringloss:0.0539, loss:0.1408, train acc: 1.0000
3.907595157623291
step: 900, ce loss: 0.1777, ringloss:0.1761, loss:0.3538, train acc: 0.9688
Loss is:0.1817/0.1027, Train Accuracy is:97.40%, Test Accuracy is:96.28%, {'epoch': 24, 'accuracy': 0.9632}
0.9865, 0.9865, 0.9632, 0.9726, 0.9740, 0.9720, 0.9836, 0.9767, 0.9593, 0.9635
0.9908, 0.9789, 0.9612, 0.9584, 0.9532, 0.9619, 0.9854, 0.9514, 0.9322, 0.9534
Epoch 26/40
----------
3.908097982406616
step: 0, ce loss: 0.3328, ringloss:0.1641, loss:0.4969, train acc: 0.9844
3.911625623703003
step: 100, ce loss: 0.1801, ringloss:0.1203, loss:0.3004, train acc: 0.9688
3.9153592586517334
step: 200, ce loss: 0.1836, ringloss:0.1391, loss:0.3227, train acc: 0.9688
3.917520046234131
step: 300, ce loss: 0.1313, ringloss:0.0800, loss:0.2112, train acc: 0.9844
3.919361114501953
step: 400, ce loss: 0.2076, ringloss:0.0720, loss:0.2796, train acc: 0.9531
3.9223973751068115
step: 500, ce loss: 0.2018, ringloss:0.1037, loss:0.3055, train acc: 0.9375
3.9249751567840576
step: 600, ce loss: 0.2505, ringloss:0.1290, loss:0.3794, train acc: 0.9375
3.9271950721740723
step: 700, ce loss: 0.1246, ringloss:0.1049, loss:0.2295, train acc: 0.9531
3.9289915561676025
step: 800, ce loss: 0.1017, ringloss:0.0813, loss:0.1831, train acc: 1.0000
3.9328296184539795
step: 900, ce loss: 0.3123, ringloss:0.1124, loss:0.4247, train acc: 0.9531
Loss is:0.1795/0.1033, Train Accuracy is:97.33%, Test Accuracy is:96.67%, {'epoch': 26, 'accuracy': 0.9667}
0.9878, 0.9844, 0.9612, 0.9711, 0.9738, 0.9703, 0.9823, 0.9775, 0.9597, 0.9625
0.9857, 0.9806, 0.9574, 0.9634, 0.9613, 0.9630, 0.9854, 0.9679, 0.9528, 0.9485
Epoch 27/40
----------
3.933591365814209
step: 0, ce loss: 0.3111, ringloss:0.1165, loss:0.4276, train acc: 0.9531
3.9384467601776123
step: 100, ce loss: 0.1396, ringloss:0.1388, loss:0.2783, train acc: 0.9844
3.941479206085205
step: 200, ce loss: 0.1013, ringloss:0.0828, loss:0.1842, train acc: 1.0000
3.9442403316497803
step: 300, ce loss: 0.1853, ringloss:0.1047, loss:0.2900, train acc: 0.9531
3.9473955631256104
step: 400, ce loss: 0.2758, ringloss:0.1734, loss:0.4492, train acc: 0.9531
3.9480299949645996
step: 500, ce loss: 0.1067, ringloss:0.0858, loss:0.1925, train acc: 1.0000
3.952065944671631
step: 600, ce loss: 0.0912, ringloss:0.0591, loss:0.1503, train acc: 1.0000
3.9546635150909424
step: 700, ce loss: 0.1883, ringloss:0.0846, loss:0.2729, train acc: 0.9688
3.955308198928833
step: 800, ce loss: 0.4088, ringloss:0.1062, loss:0.5150, train acc: 0.9375
3.9555253982543945
step: 900, ce loss: 0.1665, ringloss:0.1047, loss:0.2712, train acc: 0.9688
Loss is:0.1804/0.1038, Train Accuracy is:97.43%, Test Accuracy is:96.60%, {'epoch': 26, 'accuracy': 0.9667}
0.9880, 0.9858, 0.9671, 0.9706, 0.9745, 0.9710, 0.9826, 0.9772, 0.9602, 0.9640
0.9888, 0.9780, 0.9477, 0.9723, 0.9817, 0.9596, 0.9760, 0.9679, 0.9405, 0.9465
Epoch 28/40
----------
3.95560622215271
step: 0, ce loss: 0.1103, ringloss:0.0783, loss:0.1887, train acc: 0.9844
3.959312677383423
step: 100, ce loss: 0.1186, ringloss:0.1013, loss:0.2198, train acc: 1.0000
3.962430000305176
step: 200, ce loss: 0.1060, ringloss:0.1122, loss:0.2182, train acc: 1.0000
3.964425802230835
step: 300, ce loss: 0.2234, ringloss:0.0903, loss:0.3136, train acc: 0.9688
3.9676873683929443
step: 400, ce loss: 0.1153, ringloss:0.0712, loss:0.1866, train acc: 1.0000
3.9706718921661377
step: 500, ce loss: 0.1898, ringloss:0.0925, loss:0.2824, train acc: 0.9688
3.973538875579834
step: 600, ce loss: 0.1569, ringloss:0.1215, loss:0.2784, train acc: 0.9688
3.9749674797058105
step: 700, ce loss: 0.2304, ringloss:0.1340, loss:0.3643, train acc: 0.9688
3.975703239440918
step: 800, ce loss: 0.1699, ringloss:0.0744, loss:0.2443, train acc: 0.9688
3.9768929481506348
step: 900, ce loss: 0.0834, ringloss:0.0588, loss:0.1422, train acc: 1.0000
Loss is:0.1720/0.1059, Train Accuracy is:97.52%, Test Accuracy is:96.58%, {'epoch': 26, 'accuracy': 0.9667}
0.9872, 0.9856, 0.9641, 0.9729, 0.9796, 0.9697, 0.9845, 0.9786, 0.9619, 0.9662
0.9867, 0.9833, 0.9545, 0.9515, 0.9684, 0.9630, 0.9812, 0.9679, 0.9466, 0.9534
Epoch 29/40
----------
3.977839469909668
step: 0, ce loss: 0.1317, ringloss:0.1355, loss:0.2672, train acc: 0.9844
3.981985569000244
step: 100, ce loss: 0.1093, ringloss:0.0844, loss:0.1937, train acc: 0.9844
3.9859933853149414
step: 200, ce loss: 0.0846, ringloss:0.0544, loss:0.1390, train acc: 1.0000
3.9898898601531982
step: 300, ce loss: 0.2131, ringloss:0.0886, loss:0.3017, train acc: 0.9531
3.993337392807007
step: 400, ce loss: 0.5281, ringloss:0.1216, loss:0.6497, train acc: 0.9688
3.9950037002563477
step: 500, ce loss: 0.1294, ringloss:0.1023, loss:0.2317, train acc: 0.9688
3.996649742126465
step: 600, ce loss: 0.0960, ringloss:0.0588, loss:0.1549, train acc: 1.0000
3.99928617477417
step: 700, ce loss: 0.1058, ringloss:0.0651, loss:0.1709, train acc: 1.0000
4.000635623931885
step: 800, ce loss: 0.2492, ringloss:0.1673, loss:0.4164, train acc: 0.9375
4.0018310546875
step: 900, ce loss: 0.4361, ringloss:0.1085, loss:0.5446, train acc: 0.9844
Loss is:0.1665/0.0974, Train Accuracy is:97.55%, Test Accuracy is:96.01%, {'epoch': 26, 'accuracy': 0.9667}
0.9894, 0.9835, 0.9673, 0.9726, 0.9777, 0.9703, 0.9851, 0.9785, 0.9603, 0.9687
0.9827, 0.9815, 0.9671, 0.9337, 0.9623, 0.9283, 0.9749, 0.9660, 0.9497, 0.9495
Epoch 30/40
----------
4.0020575523376465
step: 0, ce loss: 0.5986, ringloss:0.1603, loss:0.7589, train acc: 0.9375
4.004927635192871
step: 100, ce loss: 0.1462, ringloss:0.0812, loss:0.2275, train acc: 0.9844
4.007066249847412
step: 200, ce loss: 0.1631, ringloss:0.0925, loss:0.2555, train acc: 0.9688
4.011828422546387
step: 300, ce loss: 0.1476, ringloss:0.1249, loss:0.2724, train acc: 0.9688
4.0152907371521
step: 400, ce loss: 0.0790, ringloss:0.0498, loss:0.1289, train acc: 1.0000
4.017403602600098
step: 500, ce loss: 0.1070, ringloss:0.0996, loss:0.2066, train acc: 1.0000
4.0189433097839355
step: 600, ce loss: 0.1249, ringloss:0.1118, loss:0.2367, train acc: 0.9844
4.021181583404541
step: 700, ce loss: 0.1989, ringloss:0.1497, loss:0.3485, train acc: 0.9844
4.022480487823486
step: 800, ce loss: 0.1052, ringloss:0.1105, loss:0.2156, train acc: 1.0000
4.021887302398682
step: 900, ce loss: 0.3203, ringloss:0.1103, loss:0.4306, train acc: 0.9688
Loss is:0.1682/0.0998, Train Accuracy is:97.57%, Test Accuracy is:96.43%, {'epoch': 26, 'accuracy': 0.9667}
0.9875, 0.9852, 0.9691, 0.9713, 0.9779, 0.9692, 0.9834, 0.9792, 0.9626, 0.9696
0.9867, 0.9824, 0.9641, 0.9614, 0.9511, 0.9641, 0.9791, 0.9689, 0.9456, 0.9376
Epoch 31/40
----------
4.023754119873047
step: 0, ce loss: 0.1103, ringloss:0.1289, loss:0.2392, train acc: 0.9844
4.028177738189697
step: 100, ce loss: 0.1149, ringloss:0.1309, loss:0.2458, train acc: 0.9844
4.032805919647217
step: 200, ce loss: 0.7324, ringloss:0.1134, loss:0.8459, train acc: 0.9375
4.034933567047119
step: 300, ce loss: 0.0972, ringloss:0.0728, loss:0.1701, train acc: 1.0000
4.039741039276123
step: 400, ce loss: 0.2713, ringloss:0.0717, loss:0.3430, train acc: 0.9844
4.043365955352783
step: 500, ce loss: 0.0950, ringloss:0.0589, loss:0.1539, train acc: 1.0000
4.044483184814453
step: 600, ce loss: 0.1380, ringloss:0.1036, loss:0.2416, train acc: 0.9688
4.046275615692139
step: 700, ce loss: 0.2514, ringloss:0.0836, loss:0.3350, train acc: 0.9531
4.0467071533203125
step: 800, ce loss: 0.1261, ringloss:0.0806, loss:0.2067, train acc: 0.9844
4.048323154449463
step: 900, ce loss: 0.1467, ringloss:0.0707, loss:0.2174, train acc: 0.9531
Loss is:0.1631/0.0987, Train Accuracy is:97.59%, Test Accuracy is:95.82%, {'epoch': 26, 'accuracy': 0.9667}
0.9885, 0.9856, 0.9710, 0.9728, 0.9765, 0.9697, 0.9833, 0.9804, 0.9609, 0.9679
0.9765, 0.9744, 0.9448, 0.9248, 0.9674, 0.9484, 0.9593, 0.9611, 0.9517, 0.9713
Epoch 32/40
----------
4.04854679107666
step: 0, ce loss: 0.2251, ringloss:0.1164, loss:0.3416, train acc: 0.9688
4.050312519073486
step: 100, ce loss: 0.4136, ringloss:0.0796, loss:0.4932, train acc: 0.9844
4.05349063873291
step: 200, ce loss: 0.4573, ringloss:0.0688, loss:0.5261, train acc: 0.9531
4.056516647338867
step: 300, ce loss: 0.1040, ringloss:0.0954, loss:0.1994, train acc: 0.9844
4.058755874633789
step: 400, ce loss: 0.2187, ringloss:0.0960, loss:0.3147, train acc: 0.9844
4.062510013580322
step: 500, ce loss: 0.1795, ringloss:0.1008, loss:0.2803, train acc: 0.9531
4.066314220428467
step: 600, ce loss: 0.1018, ringloss:0.0505, loss:0.1523, train acc: 0.9844
4.0682692527771
step: 700, ce loss: 0.2542, ringloss:0.1084, loss:0.3626, train acc: 0.9219
4.070107936859131
step: 800, ce loss: 0.1138, ringloss:0.0947, loss:0.2085, train acc: 0.9844
4.072630405426025
step: 900, ce loss: 0.2502, ringloss:0.1072, loss:0.3574, train acc: 0.9844
Loss is:0.1599/0.0945, Train Accuracy is:97.72%, Test Accuracy is:96.58%, {'epoch': 26, 'accuracy': 0.9667}
0.9868, 0.9867, 0.9748, 0.9737, 0.9793, 0.9690, 0.9865, 0.9802, 0.9634, 0.9689
0.9888, 0.9833, 0.9448, 0.9772, 0.9715, 0.9552, 0.9457, 0.9728, 0.9517, 0.9633
Epoch 33/40
----------
4.073606014251709
step: 0, ce loss: 0.0885, ringloss:0.0834, loss:0.1719, train acc: 1.0000
4.077864646911621
step: 100, ce loss: 0.1384, ringloss:0.0559, loss:0.1944, train acc: 0.9688
4.081328392028809
step: 200, ce loss: 0.1868, ringloss:0.0742, loss:0.2609, train acc: 0.9844
4.084003448486328
step: 300, ce loss: 0.1093, ringloss:0.1532, loss:0.2625, train acc: 0.9844
4.087231636047363
step: 400, ce loss: 0.2850, ringloss:0.0983, loss:0.3833, train acc: 0.9688
4.0889716148376465
step: 500, ce loss: 0.4606, ringloss:0.2118, loss:0.6724, train acc: 0.9531
4.089231491088867
step: 600, ce loss: 0.3167, ringloss:0.1591, loss:0.4758, train acc: 0.9688
4.087846755981445
step: 700, ce loss: 0.2403, ringloss:0.1735, loss:0.4138, train acc: 0.9375
4.087907314300537
step: 800, ce loss: 0.1396, ringloss:0.0980, loss:0.2376, train acc: 0.9688
4.0903754234313965
step: 900, ce loss: 0.0809, ringloss:0.0523, loss:0.1332, train acc: 1.0000
Loss is:0.1656/0.0962, Train Accuracy is:97.62%, Test Accuracy is:96.39%, {'epoch': 26, 'accuracy': 0.9667}
0.9892, 0.9847, 0.9681, 0.9715, 0.9807, 0.9718, 0.9839, 0.9781, 0.9634, 0.9696
0.9878, 0.9806, 0.9661, 0.9545, 0.9888, 0.9518, 0.9572, 0.9582, 0.9507, 0.9405
Epoch 34/40
----------
4.090144634246826
step: 0, ce loss: 0.1336, ringloss:0.1092, loss:0.2428, train acc: 0.9844
4.092827796936035
step: 100, ce loss: 0.1057, ringloss:0.0626, loss:0.1682, train acc: 0.9688
4.096834659576416
step: 200, ce loss: 0.1190, ringloss:0.1348, loss:0.2538, train acc: 0.9844
4.099032878875732
step: 300, ce loss: 0.2246, ringloss:0.1171, loss:0.3417, train acc: 0.9844
4.100614547729492
step: 400, ce loss: 0.4508, ringloss:0.1242, loss:0.5751, train acc: 0.9375
4.1027913093566895
step: 500, ce loss: 0.2682, ringloss:0.0901, loss:0.3582, train acc: 0.9531
4.104994773864746
step: 600, ce loss: 0.1418, ringloss:0.0773, loss:0.2191, train acc: 0.9688
4.1086506843566895
step: 700, ce loss: 0.2716, ringloss:0.0967, loss:0.3684, train acc: 0.9531
4.109555721282959
step: 800, ce loss: 0.0988, ringloss:0.0717, loss:0.1705, train acc: 0.9844
4.111670017242432
step: 900, ce loss: 0.1364, ringloss:0.1097, loss:0.2461, train acc: 0.9844
Loss is:0.1574/0.0945, Train Accuracy is:97.77%, Test Accuracy is:96.28%, {'epoch': 26, 'accuracy': 0.9667}
0.9885, 0.9868, 0.9720, 0.9731, 0.9796, 0.9753, 0.9870, 0.9807, 0.9645, 0.9684
0.9867, 0.9700, 0.9700, 0.9703, 0.9338, 0.9473, 0.9823, 0.9572, 0.9610, 0.9475
Epoch 35/40
----------
4.112833499908447
step: 0, ce loss: 0.1906, ringloss:0.1528, loss:0.3434, train acc: 0.9844
4.115360736846924
step: 100, ce loss: 0.2279, ringloss:0.0531, loss:0.2810, train acc: 0.9844
4.1201677322387695
step: 200, ce loss: 0.0943, ringloss:0.0682, loss:0.1625, train acc: 0.9844
4.123793601989746
step: 300, ce loss: 0.0919, ringloss:0.0506, loss:0.1425, train acc: 1.0000
4.12635612487793
step: 400, ce loss: 0.2138, ringloss:0.1278, loss:0.3416, train acc: 0.9531
4.127053737640381
step: 500, ce loss: 0.0981, ringloss:0.0721, loss:0.1703, train acc: 0.9844
4.129132270812988
step: 600, ce loss: 0.2101, ringloss:0.0458, loss:0.2559, train acc: 0.9844
4.131038188934326
step: 700, ce loss: 0.0813, ringloss:0.0578, loss:0.1390, train acc: 1.0000
4.131802558898926
step: 800, ce loss: 0.1403, ringloss:0.1199, loss:0.2602, train acc: 0.9688
4.134096145629883
step: 900, ce loss: 0.4836, ringloss:0.0971, loss:0.5807, train acc: 0.9531
Loss is:0.1568/0.0926, Train Accuracy is:97.72%, Test Accuracy is:96.47%, {'epoch': 26, 'accuracy': 0.9667}
0.9889, 0.9843, 0.9731, 0.9760, 0.9788, 0.9720, 0.9861, 0.9802, 0.9645, 0.9665
0.9827, 0.9780, 0.9603, 0.9416, 0.9562, 0.9720, 0.9624, 0.9737, 0.9600, 0.9594
Epoch 36/40
----------
4.132637023925781
step: 0, ce loss: 0.0823, ringloss:0.1039, loss:0.1862, train acc: 1.0000
4.136037826538086
step: 100, ce loss: 0.0856, ringloss:0.0682, loss:0.1537, train acc: 1.0000
4.13901424407959
step: 200, ce loss: 0.1827, ringloss:0.1491, loss:0.3318, train acc: 0.9531
4.141373634338379
step: 300, ce loss: 0.1045, ringloss:0.1076, loss:0.2121, train acc: 0.9688
4.1443610191345215
step: 400, ce loss: 0.0827, ringloss:0.1052, loss:0.1879, train acc: 1.0000
4.1475830078125
step: 500, ce loss: 0.1027, ringloss:0.0816, loss:0.1843, train acc: 0.9844
4.149807929992676
step: 600, ce loss: 0.1462, ringloss:0.0834, loss:0.2296, train acc: 0.9844
4.151840686798096
step: 700, ce loss: 0.1152, ringloss:0.1104, loss:0.2255, train acc: 0.9688
4.1534857749938965
step: 800, ce loss: 0.0966, ringloss:0.1179, loss:0.2145, train acc: 0.9844
4.153866767883301
step: 900, ce loss: 0.1242, ringloss:0.0979, loss:0.2221, train acc: 0.9688
Loss is:0.1529/0.0912, Train Accuracy is:97.84%, Test Accuracy is:96.57%, {'epoch': 26, 'accuracy': 0.9667}
0.9885, 0.9852, 0.9762, 0.9742, 0.9800, 0.9755, 0.9853, 0.9823, 0.9658, 0.9697
0.9776, 0.9771, 0.9390, 0.9772, 0.9654, 0.9507, 0.9781, 0.9854, 0.9507, 0.9534
Epoch 37/40
----------
4.155144691467285
step: 0, ce loss: 0.1542, ringloss:0.1362, loss:0.2904, train acc: 0.9531
4.156460285186768
step: 100, ce loss: 0.2229, ringloss:0.1417, loss:0.3646, train acc: 0.9844
4.15813684463501
step: 200, ce loss: 0.0880, ringloss:0.0644, loss:0.1523, train acc: 0.9844
4.1613616943359375
step: 300, ce loss: 0.0922, ringloss:0.0780, loss:0.1702, train acc: 0.9844
4.1645708084106445
step: 400, ce loss: 0.1310, ringloss:0.1385, loss:0.2695, train acc: 0.9688
4.16659688949585
step: 500, ce loss: 0.0758, ringloss:0.0537, loss:0.1295, train acc: 1.0000
4.167821407318115
step: 600, ce loss: 0.2080, ringloss:0.0453, loss:0.2533, train acc: 0.9688
4.16876745223999
step: 700, ce loss: 0.1515, ringloss:0.0833, loss:0.2348, train acc: 0.9531
4.170409679412842
step: 800, ce loss: 0.0947, ringloss:0.0624, loss:0.1571, train acc: 1.0000
4.173476696014404
step: 900, ce loss: 0.1208, ringloss:0.0564, loss:0.1773, train acc: 0.9844
Loss is:0.1539/0.0932, Train Accuracy is:97.68%, Test Accuracy is:96.66%, {'epoch': 26, 'accuracy': 0.9667}
0.9868, 0.9847, 0.9728, 0.9734, 0.9812, 0.9710, 0.9848, 0.9792, 0.9656, 0.9665
0.9888, 0.9797, 0.9545, 0.9792, 0.9817, 0.9339, 0.9812, 0.9679, 0.9446, 0.9504
Epoch 38/40
----------
4.173726558685303
step: 0, ce loss: 0.0890, ringloss:0.0773, loss:0.1664, train acc: 1.0000
4.1759514808654785
step: 100, ce loss: 0.0940, ringloss:0.0553, loss:0.1492, train acc: 0.9844
4.177600860595703
step: 200, ce loss: 0.0973, ringloss:0.1261, loss:0.2234, train acc: 0.9844
4.180596828460693
step: 300, ce loss: 0.0792, ringloss:0.0745, loss:0.1537, train acc: 1.0000
4.18459939956665
step: 400, ce loss: 0.0780, ringloss:0.0693, loss:0.1473, train acc: 1.0000
4.187876224517822
step: 500, ce loss: 0.1614, ringloss:0.0953, loss:0.2567, train acc: 0.9844
4.189975261688232
step: 600, ce loss: 0.1102, ringloss:0.1361, loss:0.2462, train acc: 0.9844
4.191422462463379
step: 700, ce loss: 0.1355, ringloss:0.1404, loss:0.2759, train acc: 0.9688
4.192960739135742
step: 800, ce loss: 0.0937, ringloss:0.1314, loss:0.2251, train acc: 1.0000
4.1946821212768555
step: 900, ce loss: 0.0973, ringloss:0.0980, loss:0.1953, train acc: 0.9844
Loss is:0.1471/0.0920, Train Accuracy is:97.85%, Test Accuracy is:96.58%, {'epoch': 26, 'accuracy': 0.9667}
0.9899, 0.9868, 0.9703, 0.9760, 0.9820, 0.9733, 0.9868, 0.9829, 0.9663, 0.9691
0.9898, 0.9806, 0.9641, 0.9604, 0.9603, 0.9563, 0.9593, 0.9708, 0.9517, 0.9613
Epoch 39/40
----------
4.194482326507568
step: 0, ce loss: 0.1315, ringloss:0.0840, loss:0.2155, train acc: 0.9688
4.197459697723389
step: 100, ce loss: 0.1065, ringloss:0.0742, loss:0.1808, train acc: 0.9844
4.200352191925049
step: 200, ce loss: 0.0895, ringloss:0.0564, loss:0.1458, train acc: 0.9844
4.202724456787109
step: 300, ce loss: 0.1052, ringloss:0.0679, loss:0.1731, train acc: 0.9844
4.204051494598389
step: 400, ce loss: 0.0914, ringloss:0.0774, loss:0.1688, train acc: 0.9844
4.206344127655029
step: 500, ce loss: 0.2097, ringloss:0.1223, loss:0.3320, train acc: 0.9531
4.20842981338501
step: 600, ce loss: 0.1019, ringloss:0.1264, loss:0.2284, train acc: 0.9844
4.210484504699707
step: 700, ce loss: 0.1140, ringloss:0.0765, loss:0.1905, train acc: 0.9844
4.212122917175293
step: 800, ce loss: 0.1469, ringloss:0.0708, loss:0.2177, train acc: 0.9844
4.2139716148376465
step: 900, ce loss: 0.1370, ringloss:0.1179, loss:0.2549, train acc: 0.9688
Loss is:0.1477/0.0908, Train Accuracy is:97.84%, Test Accuracy is:96.30%, {'epoch': 26, 'accuracy': 0.9667}
0.9880, 0.9868, 0.9698, 0.9762, 0.9827, 0.9716, 0.9878, 0.9836, 0.9667, 0.9684
0.9776, 0.9859, 0.9516, 0.9663, 0.9593, 0.9709, 0.9603, 0.9825, 0.9446, 0.9286
Epoch 40/40
----------
4.214245796203613
step: 0, ce loss: 0.0805, ringloss:0.0617, loss:0.1421, train acc: 1.0000
4.2179083824157715
step: 100, ce loss: 0.5509, ringloss:0.0990, loss:0.6499, train acc: 0.9531
4.2212347984313965
step: 200, ce loss: 0.1029, ringloss:0.0723, loss:0.1752, train acc: 0.9844
4.224551200866699
step: 300, ce loss: 0.1360, ringloss:0.1183, loss:0.2543, train acc: 0.9844
4.226690292358398
step: 400, ce loss: 0.1432, ringloss:0.1070, loss:0.2501, train acc: 0.9844
4.226871490478516
step: 500, ce loss: 0.1597, ringloss:0.0835, loss:0.2432, train acc: 0.9844
4.227961540222168
step: 600, ce loss: 0.2854, ringloss:0.1324, loss:0.4177, train acc: 0.9688
4.229650020599365
step: 700, ce loss: 0.0806, ringloss:0.0869, loss:0.1675, train acc: 1.0000
4.231245040893555
step: 800, ce loss: 0.0990, ringloss:0.1023, loss:0.2013, train acc: 1.0000
4.232090950012207
step: 900, ce loss: 0.1173, ringloss:0.0942, loss:0.2115, train acc: 0.9844
Loss is:0.1482/0.0913, Train Accuracy is:97.80%, Test Accuracy is:96.17%, {'epoch': 26, 'accuracy': 0.9667}
0.9872, 0.9864, 0.9703, 0.9752, 0.9810, 0.9753, 0.9841, 0.9821, 0.9675, 0.9696
0.9878, 0.9762, 0.9438, 0.9802, 0.9745, 0.9428, 0.9802, 0.9650, 0.9158, 0.9475
Finish training!
The best accuracy model is: {'epoch': 26, 'accuracy': 0.9667}
weight_norm: tensor([4.1097, 4.2754, 4.1849, 4.4290, 4.1285, 4.4710, 4.2842, 3.9081, 4.1438,
        3.9466])
