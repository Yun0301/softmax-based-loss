Model(
  (backbone): Sequential(
    (0): Conv2d(1, 16, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3))
    (1): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (2): ReLU()
    (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (5): ReLU()
    (6): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (7): ReLU()
    (8): AvgPool2d(kernel_size=3, stride=3, padding=0)
  )
  (feature): Linear(in_features=64, out_features=2, bias=True)
  (pred): Linear(in_features=2, out_features=10, bias=False)
)
Epoch 1/40
----------
0.9990000128746033
step: 0, ce loss: 2.3046, ringloss:0.9177, loss:3.2224, train acc: 0.0938
0.9618603587150574
step: 100, ce loss: 2.3295, ringloss:0.0381, loss:2.3676, train acc: 0.0625
0.9492239952087402
step: 200, ce loss: 2.0621, ringloss:0.0806, loss:2.1427, train acc: 0.2656
0.9527028203010559
step: 300, ce loss: 2.0165, ringloss:0.0939, loss:2.1103, train acc: 0.2188
0.9696640968322754
step: 400, ce loss: 1.8880, ringloss:0.0979, loss:1.9859, train acc: 0.2500
0.9991768598556519
step: 500, ce loss: 1.7028, ringloss:0.1344, loss:1.8373, train acc: 0.4688
1.0484182834625244
step: 600, ce loss: 1.7871, ringloss:0.1036, loss:1.8907, train acc: 0.4531
1.1093506813049316
step: 700, ce loss: 1.7070, ringloss:0.0639, loss:1.7710, train acc: 0.4062
1.1731178760528564
step: 800, ce loss: 1.5407, ringloss:0.1121, loss:1.6528, train acc: 0.5469
1.2401667833328247
step: 900, ce loss: 1.5391, ringloss:0.0501, loss:1.5892, train acc: 0.6562
Loss is:1.8718/0.0922, Train Accuracy is:33.28%, Test Accuracy is:57.75%, {'accuracy': 0.5775, 'epoch': 1}
0.3682, 0.5214, 0.2934, 0.5661, 0.3400, 0.1245, 0.1849, 0.2536, 0.1174, 0.5082
0.7745, 0.8079, 0.4525, 0.7277, 0.3982, 0.2904, 0.6347, 0.5292, 0.3450, 0.7522
Epoch 2/40
----------
1.2657389640808105
step: 0, ce loss: 1.5460, ringloss:0.0810, loss:1.6270, train acc: 0.6406
1.3311642408370972
step: 100, ce loss: 1.4605, ringloss:0.0825, loss:1.5430, train acc: 0.6250
1.396460771560669
step: 200, ce loss: 1.5009, ringloss:0.1118, loss:1.6127, train acc: 0.6875
1.4595293998718262
step: 300, ce loss: 1.4769, ringloss:0.0882, loss:1.5651, train acc: 0.6406
1.5197720527648926
step: 400, ce loss: 1.4508, ringloss:0.1046, loss:1.5555, train acc: 0.4844
1.5783178806304932
step: 500, ce loss: 1.3112, ringloss:0.1404, loss:1.4516, train acc: 0.7188
1.6332848072052002
step: 600, ce loss: 1.3311, ringloss:0.1064, loss:1.4375, train acc: 0.6406
1.6881309747695923
step: 700, ce loss: 1.3068, ringloss:0.1041, loss:1.4108, train acc: 0.7188
1.742928147315979
step: 800, ce loss: 1.3209, ringloss:0.0933, loss:1.4143, train acc: 0.6875
1.795746922492981
step: 900, ce loss: 1.3118, ringloss:0.0875, loss:1.3993, train acc: 0.7656
Loss is:1.3911/0.0976, Train Accuracy is:65.94%, Test Accuracy is:72.74%, {'accuracy': 0.7274, 'epoch': 2}
0.7881, 0.7082, 0.6574, 0.6439, 0.5457, 0.5016, 0.7896, 0.5609, 0.6190, 0.7630
0.6765, 0.9436, 0.7762, 0.5158, 0.8707, 0.6099, 0.8643, 0.7432, 0.7536, 0.4886
Epoch 3/40
----------
1.8152079582214355
step: 0, ce loss: 1.2793, ringloss:0.0893, loss:1.3685, train acc: 0.7344
1.8661186695098877
step: 100, ce loss: 1.2611, ringloss:0.0916, loss:1.3527, train acc: 0.7344
1.9157582521438599
step: 200, ce loss: 1.2605, ringloss:0.0767, loss:1.3371, train acc: 0.7188
1.9647976160049438
step: 300, ce loss: 1.1821, ringloss:0.0756, loss:1.2577, train acc: 0.8438
2.0127086639404297
step: 400, ce loss: 1.2991, ringloss:0.0977, loss:1.3967, train acc: 0.7812
2.05983567237854
step: 500, ce loss: 1.2465, ringloss:0.0710, loss:1.3175, train acc: 0.6875
2.1083154678344727
step: 600, ce loss: 1.2874, ringloss:0.1178, loss:1.4052, train acc: 0.7344
2.1535115242004395
step: 700, ce loss: 1.2131, ringloss:0.0851, loss:1.2982, train acc: 0.7969
2.1986875534057617
step: 800, ce loss: 1.0861, ringloss:0.0820, loss:1.1681, train acc: 0.8750
2.2436447143554688
step: 900, ce loss: 1.1225, ringloss:0.0769, loss:1.1994, train acc: 0.7969
Loss is:1.2040/0.0923, Train Accuracy is:77.54%, Test Accuracy is:83.01%, {'accuracy': 0.8301, 'epoch': 3}
0.7876, 0.9215, 0.7981, 0.8344, 0.8737, 0.6344, 0.8550, 0.6870, 0.7409, 0.5942
0.8929, 0.9630, 0.7432, 0.8891, 0.9185, 0.7298, 0.7463, 0.8755, 0.7187, 0.7929
Epoch 4/40
----------
2.2607522010803223
step: 0, ce loss: 1.1060, ringloss:0.0794, loss:1.1854, train acc: 0.7812
2.3046886920928955
step: 100, ce loss: 1.1355, ringloss:0.1138, loss:1.2492, train acc: 0.8125
2.3462724685668945
step: 200, ce loss: 1.1112, ringloss:0.0918, loss:1.2029, train acc: 0.8594
2.3861589431762695
step: 300, ce loss: 1.0759, ringloss:0.0825, loss:1.1584, train acc: 0.8906
2.426177501678467
step: 400, ce loss: 1.0673, ringloss:0.0948, loss:1.1621, train acc: 0.9531
2.4661431312561035
step: 500, ce loss: 1.0380, ringloss:0.0678, loss:1.1058, train acc: 0.8750
2.504119873046875
step: 600, ce loss: 1.0413, ringloss:0.1287, loss:1.1699, train acc: 0.8750
2.5407283306121826
step: 700, ce loss: 1.1507, ringloss:0.0838, loss:1.2345, train acc: 0.8594
2.577866315841675
step: 800, ce loss: 1.0725, ringloss:0.0853, loss:1.1578, train acc: 0.8438
2.6125521659851074
step: 900, ce loss: 1.0884, ringloss:0.0682, loss:1.1567, train acc: 0.8594
Loss is:1.0874/0.0918, Train Accuracy is:84.09%, Test Accuracy is:86.00%, {'accuracy': 0.86, 'epoch': 4}
0.8420, 0.9472, 0.8241, 0.8713, 0.9023, 0.6659, 0.8973, 0.8905, 0.7269, 0.8077
0.9143, 0.9736, 0.8314, 0.9178, 0.9552, 0.6771, 0.9123, 0.8658, 0.7485, 0.7721
Epoch 5/40
----------
2.6266767978668213
step: 0, ce loss: 1.0392, ringloss:0.0809, loss:1.1201, train acc: 0.8438
2.662280797958374
step: 100, ce loss: 1.0118, ringloss:0.0579, loss:1.0697, train acc: 0.9219
2.6971189975738525
step: 200, ce loss: 1.0645, ringloss:0.0790, loss:1.1435, train acc: 0.7969
2.731351852416992
step: 300, ce loss: 0.9953, ringloss:0.0823, loss:1.0776, train acc: 0.8906
2.7658534049987793
step: 400, ce loss: 1.0256, ringloss:0.1057, loss:1.1313, train acc: 0.8594
2.7988052368164062
step: 500, ce loss: 1.1380, ringloss:0.1024, loss:1.2404, train acc: 0.8594
2.830939769744873
step: 600, ce loss: 1.0113, ringloss:0.1111, loss:1.1224, train acc: 0.8281
2.864346742630005
step: 700, ce loss: 1.0684, ringloss:0.1012, loss:1.1695, train acc: 0.8906
2.8972456455230713
step: 800, ce loss: 0.9540, ringloss:0.0689, loss:1.0229, train acc: 0.9062
2.930471420288086
step: 900, ce loss: 0.9961, ringloss:0.0649, loss:1.0610, train acc: 0.9062
Loss is:1.0103/0.0875, Train Accuracy is:86.78%, Test Accuracy is:87.88%, {'accuracy': 0.8788, 'epoch': 5}
0.8838, 0.9564, 0.8518, 0.8884, 0.9233, 0.6932, 0.9289, 0.9100, 0.7527, 0.8586
0.8816, 0.9278, 0.9264, 0.8891, 0.8635, 0.7556, 0.9603, 0.8755, 0.8162, 0.8722
Epoch 6/40
----------
2.9425318241119385
step: 0, ce loss: 0.9901, ringloss:0.1242, loss:1.1144, train acc: 0.8750
2.972860097885132
step: 100, ce loss: 0.9279, ringloss:0.0554, loss:0.9833, train acc: 0.9375
3.0025506019592285
step: 200, ce loss: 0.9607, ringloss:0.1181, loss:1.0788, train acc: 0.8594
3.032250165939331
step: 300, ce loss: 0.9200, ringloss:0.0733, loss:0.9933, train acc: 0.9375
3.0616567134857178
step: 400, ce loss: 0.9531, ringloss:0.1210, loss:1.0741, train acc: 0.9531
3.0903279781341553
step: 500, ce loss: 0.9692, ringloss:0.0919, loss:1.0611, train acc: 0.8594
3.1190524101257324
step: 600, ce loss: 0.9587, ringloss:0.0945, loss:1.0532, train acc: 0.9219
3.1470444202423096
step: 700, ce loss: 0.9731, ringloss:0.0763, loss:1.0494, train acc: 0.8594
3.175889730453491
step: 800, ce loss: 0.9738, ringloss:0.0836, loss:1.0574, train acc: 0.8438
3.2039895057678223
step: 900, ce loss: 0.9907, ringloss:0.1425, loss:1.1332, train acc: 0.8438
Loss is:0.9505/0.0927, Train Accuracy is:88.89%, Test Accuracy is:90.96%, {'accuracy': 0.9096, 'epoch': 6}
0.9102, 0.9589, 0.8664, 0.8974, 0.9353, 0.7521, 0.9398, 0.9207, 0.7930, 0.8914
0.9469, 0.9771, 0.8731, 0.9287, 0.9481, 0.8217, 0.9478, 0.8998, 0.8409, 0.8959
Epoch 7/40
----------
3.214231014251709
step: 0, ce loss: 0.9619, ringloss:0.1205, loss:1.0824, train acc: 0.9062
3.2409720420837402
step: 100, ce loss: 0.8859, ringloss:0.0556, loss:0.9415, train acc: 0.9062
3.267442226409912
step: 200, ce loss: 0.9809, ringloss:0.1011, loss:1.0821, train acc: 0.9062
3.293727159500122
step: 300, ce loss: 0.9165, ringloss:0.0916, loss:1.0081, train acc: 0.8906
3.3197429180145264
step: 400, ce loss: 0.9153, ringloss:0.0855, loss:1.0007, train acc: 0.8906
3.3452939987182617
step: 500, ce loss: 0.9096, ringloss:0.0866, loss:0.9962, train acc: 0.9219
3.3706114292144775
step: 600, ce loss: 0.8657, ringloss:0.0603, loss:0.9260, train acc: 0.9375
3.396284580230713
step: 700, ce loss: 0.9214, ringloss:0.0552, loss:0.9767, train acc: 0.9062
3.420154094696045
step: 800, ce loss: 0.8914, ringloss:0.0779, loss:0.9693, train acc: 0.9375
3.444279909133911
step: 900, ce loss: 0.8523, ringloss:0.0680, loss:0.9202, train acc: 0.9375
Loss is:0.9046/0.0911, Train Accuracy is:90.68%, Test Accuracy is:91.67%, {'accuracy': 0.9167, 'epoch': 7}
0.9380, 0.9620, 0.8808, 0.9111, 0.9427, 0.8030, 0.9503, 0.9283, 0.8296, 0.9037
0.9541, 0.9709, 0.9060, 0.9535, 0.9318, 0.8498, 0.9489, 0.8930, 0.8347, 0.9108
Epoch 8/40
----------
3.453888416290283
step: 0, ce loss: 0.8786, ringloss:0.0738, loss:0.9523, train acc: 0.9375
3.4789607524871826
step: 100, ce loss: 0.9555, ringloss:0.0870, loss:1.0425, train acc: 0.8594
3.5037999153137207
step: 200, ce loss: 0.8857, ringloss:0.1067, loss:0.9924, train acc: 0.9062
3.5276453495025635
step: 300, ce loss: 0.8362, ringloss:0.0795, loss:0.9157, train acc: 0.9531
3.5514779090881348
step: 400, ce loss: 0.8585, ringloss:0.0799, loss:0.9383, train acc: 0.9219
3.5749309062957764
step: 500, ce loss: 0.8660, ringloss:0.0466, loss:0.9125, train acc: 0.8750
3.5993168354034424
step: 600, ce loss: 0.8713, ringloss:0.0756, loss:0.9468, train acc: 0.8750
3.622755765914917
step: 700, ce loss: 0.8580, ringloss:0.0698, loss:0.9278, train acc: 0.9219
3.646977186203003
step: 800, ce loss: 0.9537, ringloss:0.1128, loss:1.0665, train acc: 0.8438
3.6698780059814453
step: 900, ce loss: 1.0137, ringloss:0.1448, loss:1.1585, train acc: 0.8438
Loss is:0.8659/0.0900, Train Accuracy is:91.66%, Test Accuracy is:92.77%, {'accuracy': 0.9277, 'epoch': 8}
0.9431, 0.9635, 0.8892, 0.9176, 0.9389, 0.8491, 0.9469, 0.9363, 0.8539, 0.9143
0.9653, 0.9727, 0.8934, 0.9495, 0.9501, 0.8800, 0.9363, 0.9222, 0.8717, 0.9257
Epoch 9/40
----------
3.6777896881103516
step: 0, ce loss: 0.8947, ringloss:0.1461, loss:1.0408, train acc: 0.9375
3.7010207176208496
step: 100, ce loss: 0.8777, ringloss:0.1398, loss:1.0175, train acc: 0.8594
3.7233259677886963
step: 200, ce loss: 0.8290, ringloss:0.0651, loss:0.8942, train acc: 0.9531
3.7454257011413574
step: 300, ce loss: 0.8314, ringloss:0.1090, loss:0.9404, train acc: 0.9219
3.767164707183838
step: 400, ce loss: 0.8247, ringloss:0.1055, loss:0.9302, train acc: 0.9531
3.787623405456543
step: 500, ce loss: 0.7940, ringloss:0.0841, loss:0.8782, train acc: 0.9375
3.8099522590637207
step: 600, ce loss: 0.8074, ringloss:0.0673, loss:0.8747, train acc: 0.8906
3.831915855407715
step: 700, ce loss: 0.7866, ringloss:0.0724, loss:0.8590, train acc: 0.9688
3.8536925315856934
step: 800, ce loss: 0.7639, ringloss:0.0454, loss:0.8094, train acc: 0.9375
3.8740904331207275
step: 900, ce loss: 0.8806, ringloss:0.1095, loss:0.9902, train acc: 0.9219
Loss is:0.8344/0.0922, Train Accuracy is:92.32%, Test Accuracy is:93.23%, {'accuracy': 0.9323, 'epoch': 9}
0.9497, 0.9656, 0.8985, 0.9253, 0.9452, 0.8663, 0.9481, 0.9358, 0.8631, 0.9223
0.9602, 0.9718, 0.9147, 0.9307, 0.9603, 0.8554, 0.9572, 0.9368, 0.9035, 0.9207
Epoch 10/40
----------
3.882005214691162
step: 0, ce loss: 0.7604, ringloss:0.0672, loss:0.8276, train acc: 0.9531
3.9030239582061768
step: 100, ce loss: 0.8030, ringloss:0.0869, loss:0.8899, train acc: 0.9219
3.9240548610687256
step: 200, ce loss: 0.8263, ringloss:0.0521, loss:0.8784, train acc: 0.9062
3.945162296295166
step: 300, ce loss: 0.7693, ringloss:0.0646, loss:0.8339, train acc: 0.9688
3.965508460998535
step: 400, ce loss: 0.7749, ringloss:0.0810, loss:0.8559, train acc: 0.9688
3.984767436981201
step: 500, ce loss: 0.7885, ringloss:0.0684, loss:0.8569, train acc: 0.9062
4.005576133728027
step: 600, ce loss: 0.8091, ringloss:0.1071, loss:0.9163, train acc: 0.9531
4.025777816772461
step: 700, ce loss: 0.7888, ringloss:0.0588, loss:0.8476, train acc: 0.9375
4.046090126037598
step: 800, ce loss: 0.8067, ringloss:0.1343, loss:0.9410, train acc: 0.8906
4.064658164978027
step: 900, ce loss: 0.7473, ringloss:0.0606, loss:0.8079, train acc: 0.9688
Loss is:0.8056/0.0915, Train Accuracy is:92.98%, Test Accuracy is:93.71%, {'accuracy': 0.9371, 'epoch': 10}
0.9563, 0.9648, 0.9032, 0.9292, 0.9439, 0.8794, 0.9525, 0.9424, 0.8863, 0.9301
0.9745, 0.9850, 0.8973, 0.9564, 0.9420, 0.8924, 0.9509, 0.9329, 0.8973, 0.9326
Epoch 11/40
----------
4.072354793548584
step: 0, ce loss: 0.7715, ringloss:0.0875, loss:0.8591, train acc: 0.9375
4.092646598815918
step: 100, ce loss: 0.7775, ringloss:0.1056, loss:0.8831, train acc: 0.9062
4.113206386566162
step: 200, ce loss: 0.7421, ringloss:0.0558, loss:0.7979, train acc: 0.9375
4.133551120758057
step: 300, ce loss: 0.7537, ringloss:0.0582, loss:0.8119, train acc: 0.9531
4.152981758117676
step: 400, ce loss: 0.8509, ringloss:0.1031, loss:0.9539, train acc: 0.8906
4.171306610107422
step: 500, ce loss: 0.7815, ringloss:0.1215, loss:0.9029, train acc: 0.9219
4.1903767585754395
step: 600, ce loss: 0.7269, ringloss:0.1363, loss:0.8632, train acc: 0.9375
4.2081098556518555
step: 700, ce loss: 0.8442, ringloss:0.0898, loss:0.9340, train acc: 0.8906
4.226002216339111
step: 800, ce loss: 0.8113, ringloss:0.0881, loss:0.8994, train acc: 0.9531
4.244309425354004
step: 900, ce loss: 0.7659, ringloss:0.0929, loss:0.8588, train acc: 0.9531
Loss is:0.7802/0.0904, Train Accuracy is:93.41%, Test Accuracy is:94.07%, {'accuracy': 0.9407, 'epoch': 11}
0.9581, 0.9654, 0.9092, 0.9366, 0.9476, 0.8917, 0.9549, 0.9488, 0.8911, 0.9282
0.9582, 0.9700, 0.9370, 0.9406, 0.9420, 0.9226, 0.9551, 0.9261, 0.9097, 0.9405
Epoch 12/40
----------
4.2511186599731445
step: 0, ce loss: 0.8075, ringloss:0.1327, loss:0.9402, train acc: 0.9375
4.269021034240723
step: 100, ce loss: 0.7431, ringloss:0.0638, loss:0.8069, train acc: 0.9531
4.287838935852051
step: 200, ce loss: 0.7490, ringloss:0.0869, loss:0.8359, train acc: 0.9375
4.306158542633057
step: 300, ce loss: 0.7609, ringloss:0.1646, loss:0.9255, train acc: 0.9219
4.324397563934326
step: 400, ce loss: 0.7164, ringloss:0.0585, loss:0.7749, train acc: 0.9531
4.34240198135376
step: 500, ce loss: 0.7515, ringloss:0.0595, loss:0.8110, train acc: 0.9375
4.360226154327393
step: 600, ce loss: 0.7633, ringloss:0.1215, loss:0.8848, train acc: 0.8750
4.377875804901123
step: 700, ce loss: 0.7103, ringloss:0.0693, loss:0.7796, train acc: 0.9688
4.396148204803467
step: 800, ce loss: 0.9970, ringloss:0.0972, loss:1.0942, train acc: 0.8906
4.413747787475586
step: 900, ce loss: 0.7192, ringloss:0.0614, loss:0.7806, train acc: 0.9531
Loss is:0.7566/0.0902, Train Accuracy is:93.86%, Test Accuracy is:93.24%, {'accuracy': 0.9407, 'epoch': 11}
0.9559, 0.9680, 0.9183, 0.9392, 0.9512, 0.9006, 0.9611, 0.9499, 0.8980, 0.9356
0.9765, 0.9841, 0.9060, 0.8980, 0.9756, 0.8969, 0.9489, 0.9212, 0.9055, 0.9039
Epoch 13/40
----------
4.420697212219238
step: 0, ce loss: 0.7570, ringloss:0.0911, loss:0.8481, train acc: 0.9062
4.4389567375183105
step: 100, ce loss: 0.7382, ringloss:0.1056, loss:0.8438, train acc: 0.9531
4.4561238288879395
step: 200, ce loss: 0.7446, ringloss:0.1059, loss:0.8505, train acc: 0.9688
4.47309684753418
step: 300, ce loss: 0.7108, ringloss:0.0777, loss:0.7885, train acc: 0.9375
4.490036487579346
step: 400, ce loss: 0.6907, ringloss:0.1134, loss:0.8041, train acc: 0.9688
4.507284641265869
step: 500, ce loss: 0.6983, ringloss:0.0816, loss:0.7799, train acc: 0.9844
4.524186611175537
step: 600, ce loss: 0.8026, ringloss:0.0700, loss:0.8727, train acc: 0.9375
4.541067123413086
step: 700, ce loss: 0.7485, ringloss:0.0492, loss:0.7977, train acc: 0.9375
4.558206558227539
step: 800, ce loss: 0.7149, ringloss:0.1368, loss:0.8517, train acc: 0.9688
4.575206279754639
step: 900, ce loss: 0.7281, ringloss:0.0772, loss:0.8052, train acc: 0.9844
Loss is:0.7376/0.0955, Train Accuracy is:93.96%, Test Accuracy is:94.13%, {'accuracy': 0.9413, 'epoch': 13}
0.9600, 0.9680, 0.9188, 0.9411, 0.9486, 0.9019, 0.9571, 0.9531, 0.9034, 0.9360
0.9571, 0.9771, 0.9370, 0.9505, 0.9623, 0.8957, 0.9520, 0.9280, 0.9055, 0.9386
Epoch 14/40
----------
4.581678867340088
step: 0, ce loss: 0.6818, ringloss:0.0549, loss:0.7367, train acc: 0.9844
4.599305152893066
step: 100, ce loss: 0.6969, ringloss:0.1183, loss:0.8151, train acc: 0.9219
4.614979267120361
step: 200, ce loss: 0.6996, ringloss:0.1263, loss:0.8259, train acc: 0.9531
4.631808280944824
step: 300, ce loss: 0.7502, ringloss:0.1529, loss:0.9031, train acc: 0.9375
4.648351192474365
step: 400, ce loss: 0.6854, ringloss:0.0685, loss:0.7539, train acc: 0.9688
4.665285587310791
step: 500, ce loss: 0.7147, ringloss:0.0742, loss:0.7889, train acc: 0.9062
4.681784629821777
step: 600, ce loss: 0.8182, ringloss:0.1178, loss:0.9360, train acc: 0.9375
4.698855876922607
step: 700, ce loss: 0.7099, ringloss:0.0609, loss:0.7708, train acc: 0.9688
4.715059757232666
step: 800, ce loss: 0.8484, ringloss:0.1213, loss:0.9696, train acc: 0.9219
4.730613708496094
step: 900, ce loss: 0.7441, ringloss:0.0590, loss:0.8031, train acc: 0.9219
Loss is:0.7193/0.0918, Train Accuracy is:94.11%, Test Accuracy is:92.86%, {'accuracy': 0.9413, 'epoch': 13}
0.9629, 0.9689, 0.9226, 0.9427, 0.9488, 0.9078, 0.9574, 0.9536, 0.9029, 0.9353
0.9663, 0.9894, 0.8643, 0.9663, 0.9369, 0.8700, 0.9405, 0.9329, 0.8655, 0.9405
Epoch 15/40
----------
4.7365827560424805
step: 0, ce loss: 0.6644, ringloss:0.0912, loss:0.7556, train acc: 0.9688
4.753032207489014
step: 100, ce loss: 0.6859, ringloss:0.0667, loss:0.7526, train acc: 0.9375
4.769179821014404
step: 200, ce loss: 0.6726, ringloss:0.0856, loss:0.7582, train acc: 0.9688
4.784664630889893
step: 300, ce loss: 0.7140, ringloss:0.1244, loss:0.8385, train acc: 0.9062
4.800531387329102
step: 400, ce loss: 0.6844, ringloss:0.0675, loss:0.7519, train acc: 0.9375
4.81654167175293
step: 500, ce loss: 0.6709, ringloss:0.0999, loss:0.7708, train acc: 0.9688
4.832188129425049
step: 600, ce loss: 0.7472, ringloss:0.1113, loss:0.8584, train acc: 0.9219
4.847108364105225
step: 700, ce loss: 0.8611, ringloss:0.0876, loss:0.9486, train acc: 0.9062
4.861057758331299
step: 800, ce loss: 0.7078, ringloss:0.0744, loss:0.7822, train acc: 0.9219
4.875953197479248
step: 900, ce loss: 0.7701, ringloss:0.0913, loss:0.8614, train acc: 0.9219
Loss is:0.7020/0.0975, Train Accuracy is:94.40%, Test Accuracy is:94.12%, {'accuracy': 0.9413, 'epoch': 13}
0.9647, 0.9720, 0.9226, 0.9447, 0.9521, 0.9111, 0.9627, 0.9539, 0.9067, 0.9418
0.9745, 0.9639, 0.9525, 0.9436, 0.9501, 0.9260, 0.9614, 0.9183, 0.9025, 0.9158
Epoch 16/40
----------
4.882018566131592
step: 0, ce loss: 0.7258, ringloss:0.0806, loss:0.8064, train acc: 0.9375
4.897768974304199
step: 100, ce loss: 0.6405, ringloss:0.0578, loss:0.6983, train acc: 0.9688
4.913326740264893
step: 200, ce loss: 0.6797, ringloss:0.0926, loss:0.7723, train acc: 0.9531
4.928727149963379
step: 300, ce loss: 0.7198, ringloss:0.1178, loss:0.8376, train acc: 0.8906
4.943331241607666
step: 400, ce loss: 0.6540, ringloss:0.0748, loss:0.7288, train acc: 0.9531
4.95844030380249
step: 500, ce loss: 0.7186, ringloss:0.0806, loss:0.7992, train acc: 0.9688
4.972752571105957
step: 600, ce loss: 0.7801, ringloss:0.1354, loss:0.9155, train acc: 0.9375
4.9866719245910645
step: 700, ce loss: 0.6823, ringloss:0.1598, loss:0.8421, train acc: 0.9375
5.000367641448975
step: 800, ce loss: 0.7778, ringloss:0.0804, loss:0.8582, train acc: 0.8906
5.014163494110107
step: 900, ce loss: 0.6794, ringloss:0.1009, loss:0.7803, train acc: 0.9219
Loss is:0.6868/0.0932, Train Accuracy is:94.60%, Test Accuracy is:94.27%, {'accuracy': 0.9427, 'epoch': 16}
0.9661, 0.9720, 0.9265, 0.9465, 0.9557, 0.9190, 0.9623, 0.9547, 0.9103, 0.9410
0.9469, 0.9621, 0.9428, 0.9396, 0.9603, 0.9283, 0.9603, 0.9280, 0.9179, 0.9376
Epoch 17/40
----------
5.019721984863281
step: 0, ce loss: 0.6544, ringloss:0.1423, loss:0.7967, train acc: 0.9375
5.033576488494873
step: 100, ce loss: 0.6499, ringloss:0.1066, loss:0.7565, train acc: 0.9375
5.047550678253174
step: 200, ce loss: 0.6207, ringloss:0.0718, loss:0.6924, train acc: 0.9688
5.061347007751465
step: 300, ce loss: 0.6283, ringloss:0.1157, loss:0.7440, train acc: 0.9531
5.07513952255249
step: 400, ce loss: 0.6641, ringloss:0.1406, loss:0.8047, train acc: 0.9688
5.088559150695801
step: 500, ce loss: 0.6551, ringloss:0.0604, loss:0.7155, train acc: 0.9531
5.1008219718933105
step: 600, ce loss: 0.6360, ringloss:0.1442, loss:0.7802, train acc: 0.9844
5.114078521728516
step: 700, ce loss: 0.6266, ringloss:0.0562, loss:0.6827, train acc: 0.9688
5.127831935882568
step: 800, ce loss: 0.6992, ringloss:0.1173, loss:0.8164, train acc: 0.9219
5.141473770141602
step: 900, ce loss: 0.6240, ringloss:0.0995, loss:0.7235, train acc: 0.9688
Loss is:0.6733/0.0984, Train Accuracy is:94.59%, Test Accuracy is:94.52%, {'accuracy': 0.9452, 'epoch': 17}
0.9667, 0.9727, 0.9243, 0.9432, 0.9564, 0.9172, 0.9613, 0.9550, 0.9132, 0.9428
0.9755, 0.9780, 0.9390, 0.9535, 0.9644, 0.9193, 0.9499, 0.9319, 0.8871, 0.9465
Epoch 18/40
----------
5.146394729614258
step: 0, ce loss: 0.6677, ringloss:0.1269, loss:0.7946, train acc: 0.9375
5.159539222717285
step: 100, ce loss: 0.7458, ringloss:0.1669, loss:0.9127, train acc: 0.8906
5.173762321472168
step: 200, ce loss: 0.6347, ringloss:0.0722, loss:0.7068, train acc: 0.9688
5.18705415725708
step: 300, ce loss: 0.6536, ringloss:0.0999, loss:0.7536, train acc: 0.9844
5.200427532196045
step: 400, ce loss: 0.6241, ringloss:0.0574, loss:0.6815, train acc: 0.9844
5.213296890258789
step: 500, ce loss: 0.9417, ringloss:0.1746, loss:1.1163, train acc: 0.9062
5.226614952087402
step: 600, ce loss: 0.6689, ringloss:0.0719, loss:0.7408, train acc: 0.9688
5.239284038543701
step: 700, ce loss: 0.6302, ringloss:0.0460, loss:0.6762, train acc: 0.9844
5.251935005187988
step: 800, ce loss: 0.6413, ringloss:0.0807, loss:0.7221, train acc: 0.9219
5.264614582061768
step: 900, ce loss: 0.6765, ringloss:0.1241, loss:0.8006, train acc: 0.9219
Loss is:0.6596/0.0964, Train Accuracy is:94.84%, Test Accuracy is:94.71%, {'accuracy': 0.9471, 'epoch': 18}
0.9666, 0.9714, 0.9283, 0.9481, 0.9575, 0.9233, 0.9635, 0.9550, 0.9180, 0.9464
0.9714, 0.9833, 0.9467, 0.9535, 0.9593, 0.9350, 0.9509, 0.9134, 0.9251, 0.9277
Epoch 19/40
----------
5.269502639770508
step: 0, ce loss: 0.6276, ringloss:0.0536, loss:0.6812, train acc: 0.9531
5.282987117767334
step: 100, ce loss: 0.6350, ringloss:0.1103, loss:0.7452, train acc: 0.9531
5.295444965362549
step: 200, ce loss: 0.5840, ringloss:0.0789, loss:0.6629, train acc: 0.9844
5.3070268630981445
step: 300, ce loss: 0.6318, ringloss:0.0703, loss:0.7021, train acc: 0.9844
5.318585395812988
step: 400, ce loss: 0.6195, ringloss:0.0502, loss:0.6698, train acc: 0.9844
5.3307671546936035
step: 500, ce loss: 0.6161, ringloss:0.0650, loss:0.6811, train acc: 0.9531
5.342343807220459
step: 600, ce loss: 0.6474, ringloss:0.0847, loss:0.7321, train acc: 0.9531
5.355016231536865
step: 700, ce loss: 0.6033, ringloss:0.0678, loss:0.6711, train acc: 0.9688
5.367110252380371
step: 800, ce loss: 0.5870, ringloss:0.1046, loss:0.6917, train acc: 0.9375
5.379922389984131
step: 900, ce loss: 0.6407, ringloss:0.0803, loss:0.7210, train acc: 0.9531
Loss is:0.6480/0.0981, Train Accuracy is:94.94%, Test Accuracy is:94.78%, {'accuracy': 0.9478, 'epoch': 19}
0.9671, 0.9717, 0.9329, 0.9475, 0.9575, 0.9260, 0.9643, 0.9553, 0.9236, 0.9428
0.9755, 0.9833, 0.9360, 0.9446, 0.9623, 0.9271, 0.9593, 0.9397, 0.9138, 0.9306
Epoch 20/40
----------
5.384700775146484
step: 0, ce loss: 0.6254, ringloss:0.0991, loss:0.7245, train acc: 0.9375
5.397244930267334
step: 100, ce loss: 0.7034, ringloss:0.1005, loss:0.8039, train acc: 0.9219
5.409943103790283
step: 200, ce loss: 0.6423, ringloss:0.0758, loss:0.7180, train acc: 0.9219
5.422675609588623
step: 300, ce loss: 0.6649, ringloss:0.0802, loss:0.7451, train acc: 0.9531
5.434756278991699
step: 400, ce loss: 0.6082, ringloss:0.0867, loss:0.6949, train acc: 0.9688
5.446817874908447
step: 500, ce loss: 0.7672, ringloss:0.0992, loss:0.8664, train acc: 0.9219
5.458063125610352
step: 600, ce loss: 0.6040, ringloss:0.0630, loss:0.6670, train acc: 0.9375
5.470761775970459
step: 700, ce loss: 0.6056, ringloss:0.0801, loss:0.6857, train acc: 0.9531
5.483360290527344
step: 800, ce loss: 0.6066, ringloss:0.0771, loss:0.6837, train acc: 0.9531
5.496220588684082
step: 900, ce loss: 0.6369, ringloss:0.0833, loss:0.7202, train acc: 0.9219
Loss is:0.6369/0.0940, Train Accuracy is:95.05%, Test Accuracy is:94.69%, {'accuracy': 0.9478, 'epoch': 19}
0.9694, 0.9739, 0.9339, 0.9506, 0.9579, 0.9255, 0.9654, 0.9571, 0.9200, 0.9452
0.9847, 0.9797, 0.9273, 0.9307, 0.9633, 0.9238, 0.9582, 0.9377, 0.9292, 0.9296
Epoch 21/40
----------
5.501324653625488
step: 0, ce loss: 0.6149, ringloss:0.0655, loss:0.6804, train acc: 0.9688
5.513851165771484
step: 100, ce loss: 0.6284, ringloss:0.0996, loss:0.7280, train acc: 0.9375
5.525885105133057
step: 200, ce loss: 0.6325, ringloss:0.0942, loss:0.7267, train acc: 0.8750
5.537865161895752
step: 300, ce loss: 0.5931, ringloss:0.0857, loss:0.6789, train acc: 0.9688
5.549668312072754
step: 400, ce loss: 0.6261, ringloss:0.0999, loss:0.7260, train acc: 0.9219
5.561829090118408
step: 500, ce loss: 0.6197, ringloss:0.0675, loss:0.6872, train acc: 0.9375
5.573507785797119
step: 600, ce loss: 0.6199, ringloss:0.0767, loss:0.6966, train acc: 0.9375
5.5861592292785645
step: 700, ce loss: 0.6610, ringloss:0.0810, loss:0.7420, train acc: 0.9531
5.598297119140625
step: 800, ce loss: 0.6664, ringloss:0.1028, loss:0.7692, train acc: 0.9375
5.610030174255371
step: 900, ce loss: 0.6784, ringloss:0.0976, loss:0.7760, train acc: 0.9844
Loss is:0.6259/0.0973, Train Accuracy is:95.09%, Test Accuracy is:95.02%, {'accuracy': 0.9502, 'epoch': 21}
0.9730, 0.9721, 0.9335, 0.9504, 0.9586, 0.9229, 0.9630, 0.9591, 0.9227, 0.9474
0.9694, 0.9771, 0.9244, 0.9564, 0.9460, 0.9316, 0.9468, 0.9553, 0.9405, 0.9495
Epoch 22/40
----------
5.614477634429932
step: 0, ce loss: 0.6907, ringloss:0.0975, loss:0.7883, train acc: 0.9688
5.626675128936768
step: 100, ce loss: 0.5633, ringloss:0.0656, loss:0.6289, train acc: 0.9844
5.638619422912598
step: 200, ce loss: 0.5893, ringloss:0.0907, loss:0.6800, train acc: 0.9688
5.650674819946289
step: 300, ce loss: 0.6976, ringloss:0.0721, loss:0.7697, train acc: 0.9062
5.662642478942871
step: 400, ce loss: 0.5902, ringloss:0.1731, loss:0.7633, train acc: 0.9688
5.674330711364746
step: 500, ce loss: 0.6068, ringloss:0.0765, loss:0.6833, train acc: 0.9531
5.686007022857666
step: 600, ce loss: 0.5988, ringloss:0.0710, loss:0.6698, train acc: 0.9844
5.698151588439941
step: 700, ce loss: 0.6041, ringloss:0.1732, loss:0.7773, train acc: 0.9219
5.709674835205078
step: 800, ce loss: 0.5826, ringloss:0.1036, loss:0.6862, train acc: 0.9531
5.721476078033447
step: 900, ce loss: 0.5705, ringloss:0.0747, loss:0.6452, train acc: 0.9375
Loss is:0.6150/0.0970, Train Accuracy is:95.25%, Test Accuracy is:94.03%, {'accuracy': 0.9502, 'epoch': 21}
0.9683, 0.9745, 0.9367, 0.9486, 0.9613, 0.9297, 0.9657, 0.9587, 0.9279, 0.9487
0.9786, 0.9850, 0.9254, 0.9772, 0.9623, 0.8711, 0.9468, 0.9426, 0.8593, 0.9405
Epoch 23/40
----------
5.7257184982299805
step: 0, ce loss: 0.6007, ringloss:0.0764, loss:0.6771, train acc: 0.9531
5.737271308898926
step: 100, ce loss: 0.5642, ringloss:0.0618, loss:0.6260, train acc: 0.9688
5.747949123382568
step: 200, ce loss: 0.5579, ringloss:0.0700, loss:0.6280, train acc: 0.9688
5.759718894958496
step: 300, ce loss: 0.5658, ringloss:0.0691, loss:0.6350, train acc: 0.9688
5.771712779998779
step: 400, ce loss: 0.5879, ringloss:0.0969, loss:0.6848, train acc: 0.9219
5.783212661743164
step: 500, ce loss: 0.5674, ringloss:0.0614, loss:0.6288, train acc: 0.9688
5.794796466827393
step: 600, ce loss: 0.6180, ringloss:0.1295, loss:0.7475, train acc: 0.9375
5.805967807769775
step: 700, ce loss: 0.5434, ringloss:0.0375, loss:0.5809, train acc: 1.0000
5.817797660827637
step: 800, ce loss: 0.5404, ringloss:0.0613, loss:0.6017, train acc: 1.0000
5.828462600708008
step: 900, ce loss: 0.6094, ringloss:0.0782, loss:0.6876, train acc: 0.9375
Loss is:0.6057/0.0952, Train Accuracy is:95.28%, Test Accuracy is:93.82%, {'accuracy': 0.9502, 'epoch': 21}
0.9732, 0.9721, 0.9377, 0.9530, 0.9613, 0.9321, 0.9637, 0.9571, 0.9227, 0.9497
0.9408, 0.9850, 0.9390, 0.9822, 0.9470, 0.8576, 0.9656, 0.9465, 0.8645, 0.9376
Epoch 24/40
----------
5.832910060882568
step: 0, ce loss: 0.7574, ringloss:0.0696, loss:0.8270, train acc: 0.9531
5.843827247619629
step: 100, ce loss: 0.6143, ringloss:0.0806, loss:0.6949, train acc: 0.9219
5.855571269989014
step: 200, ce loss: 0.5633, ringloss:0.2049, loss:0.7681, train acc: 0.9219
5.866745471954346
step: 300, ce loss: 0.7133, ringloss:0.0830, loss:0.7962, train acc: 0.9531
5.878197193145752
step: 400, ce loss: 0.6622, ringloss:0.1517, loss:0.8139, train acc: 0.9375
5.8892388343811035
step: 500, ce loss: 0.5358, ringloss:0.0656, loss:0.6014, train acc: 0.9531
5.901031017303467
step: 600, ce loss: 0.6100, ringloss:0.0752, loss:0.6852, train acc: 0.9062
5.911899089813232
step: 700, ce loss: 0.5650, ringloss:0.0763, loss:0.6413, train acc: 0.9531
5.922695159912109
step: 800, ce loss: 0.5617, ringloss:0.0706, loss:0.6323, train acc: 0.9375
5.934605598449707
step: 900, ce loss: 0.6422, ringloss:0.0775, loss:0.7198, train acc: 0.9531
Loss is:0.5971/0.1014, Train Accuracy is:95.30%, Test Accuracy is:94.70%, {'accuracy': 0.9502, 'epoch': 21}
0.9752, 0.9746, 0.9374, 0.9483, 0.9599, 0.9321, 0.9667, 0.9583, 0.9231, 0.9489
0.9673, 0.9789, 0.9099, 0.9673, 0.9511, 0.9193, 0.9562, 0.9416, 0.9251, 0.9475
Epoch 25/40
----------
5.938716888427734
step: 0, ce loss: 0.6019, ringloss:0.1175, loss:0.7193, train acc: 0.8906
5.949516296386719
step: 100, ce loss: 0.5320, ringloss:0.0898, loss:0.6218, train acc: 1.0000
5.9611124992370605
step: 200, ce loss: 0.5689, ringloss:0.1275, loss:0.6964, train acc: 0.9688
5.972361087799072
step: 300, ce loss: 0.5722, ringloss:0.1146, loss:0.6868, train acc: 0.9531
5.983553886413574
step: 400, ce loss: 0.5918, ringloss:0.0973, loss:0.6891, train acc: 0.9844
5.994519233703613
step: 500, ce loss: 0.5615, ringloss:0.1225, loss:0.6840, train acc: 0.9531
6.00461483001709
step: 600, ce loss: 0.5186, ringloss:0.0482, loss:0.5668, train acc: 1.0000
6.014448642730713
step: 700, ce loss: 0.5466, ringloss:0.0784, loss:0.6250, train acc: 0.9844
6.024048805236816
step: 800, ce loss: 0.5427, ringloss:0.0680, loss:0.6107, train acc: 0.9531
6.034689426422119
step: 900, ce loss: 0.5527, ringloss:0.0582, loss:0.6109, train acc: 0.9531
Loss is:0.5874/0.1011, Train Accuracy is:95.38%, Test Accuracy is:95.21%, {'accuracy': 0.9521, 'epoch': 25}
0.9720, 0.9736, 0.9401, 0.9494, 0.9610, 0.9297, 0.9682, 0.9606, 0.9250, 0.9533
0.9663, 0.9850, 0.9554, 0.9386, 0.9623, 0.9439, 0.9656, 0.9280, 0.9374, 0.9346
Epoch 26/40
----------
6.038854122161865
step: 0, ce loss: 0.5618, ringloss:0.0857, loss:0.6475, train acc: 0.9688
6.04883337020874
step: 100, ce loss: 0.5243, ringloss:0.0674, loss:0.5917, train acc: 1.0000
6.0597381591796875
step: 200, ce loss: 0.5405, ringloss:0.1540, loss:0.6946, train acc: 0.9688
6.069863319396973
step: 300, ce loss: 0.6455, ringloss:0.0944, loss:0.7399, train acc: 0.9531
6.079267978668213
step: 400, ce loss: 0.6387, ringloss:0.1007, loss:0.7394, train acc: 0.9219
6.089261531829834
step: 500, ce loss: 0.5595, ringloss:0.0612, loss:0.6207, train acc: 0.9844
6.099964141845703
step: 600, ce loss: 0.5996, ringloss:0.1463, loss:0.7460, train acc: 0.9219
6.10932731628418
step: 700, ce loss: 0.5460, ringloss:0.0711, loss:0.6172, train acc: 0.9531
6.119401931762695
step: 800, ce loss: 0.5415, ringloss:0.1032, loss:0.6447, train acc: 0.9688
6.12915563583374
step: 900, ce loss: 0.5398, ringloss:0.1411, loss:0.6809, train acc: 0.9688
Loss is:0.5792/0.1039, Train Accuracy is:95.42%, Test Accuracy is:95.44%, {'accuracy': 0.9544, 'epoch': 26}
0.9693, 0.9748, 0.9446, 0.9506, 0.9627, 0.9279, 0.9665, 0.9620, 0.9241, 0.9543
0.9786, 0.9797, 0.9545, 0.9475, 0.9674, 0.9294, 0.9687, 0.9455, 0.9230, 0.9445
Epoch 27/40
----------
6.13303804397583
step: 0, ce loss: 0.5469, ringloss:0.0672, loss:0.6141, train acc: 0.9844
6.143490791320801
step: 100, ce loss: 0.5184, ringloss:0.1095, loss:0.6278, train acc: 0.9844
6.1542510986328125
step: 200, ce loss: 0.5611, ringloss:0.0570, loss:0.6181, train acc: 0.9688
6.164271354675293
step: 300, ce loss: 0.5657, ringloss:0.1137, loss:0.6794, train acc: 0.9531
6.174068450927734
step: 400, ce loss: 0.5193, ringloss:0.0904, loss:0.6097, train acc: 0.9844
6.1838483810424805
step: 500, ce loss: 0.5833, ringloss:0.0606, loss:0.6439, train acc: 0.9688
6.1940765380859375
step: 600, ce loss: 0.5626, ringloss:0.0649, loss:0.6275, train acc: 0.9531
6.203584671020508
step: 700, ce loss: 0.5232, ringloss:0.0771, loss:0.6004, train acc: 0.9688
6.214177131652832
step: 800, ce loss: 0.5626, ringloss:0.1056, loss:0.6682, train acc: 0.9219
6.223898887634277
step: 900, ce loss: 0.5363, ringloss:0.1714, loss:0.7076, train acc: 0.9688
Loss is:0.5709/0.0981, Train Accuracy is:95.55%, Test Accuracy is:94.74%, {'accuracy': 0.9544, 'epoch': 26}
0.9733, 0.9739, 0.9434, 0.9525, 0.9615, 0.9303, 0.9701, 0.9628, 0.9292, 0.9529
0.9714, 0.9903, 0.9583, 0.9584, 0.9613, 0.9193, 0.9269, 0.9562, 0.8799, 0.9405
Epoch 28/40
----------
6.227822780609131
step: 0, ce loss: 0.5383, ringloss:0.0776, loss:0.6159, train acc: 0.9844
6.237849712371826
step: 100, ce loss: 0.5230, ringloss:0.0953, loss:0.6183, train acc: 0.9844
6.248076915740967
step: 200, ce loss: 0.5959, ringloss:0.1284, loss:0.7242, train acc: 0.9062
6.257472991943359
step: 300, ce loss: 0.5660, ringloss:0.1481, loss:0.7141, train acc: 0.9375
6.267241954803467
step: 400, ce loss: 0.5216, ringloss:0.0688, loss:0.5904, train acc: 0.9844
6.2766218185424805
step: 500, ce loss: 0.4735, ringloss:0.0507, loss:0.5242, train acc: 1.0000
6.286563396453857
step: 600, ce loss: 0.5342, ringloss:0.1001, loss:0.6343, train acc: 0.9688
6.296229839324951
step: 700, ce loss: 0.7322, ringloss:0.0856, loss:0.8178, train acc: 0.9219
6.306024074554443
step: 800, ce loss: 0.5232, ringloss:0.0670, loss:0.5901, train acc: 0.9844
6.315226078033447
step: 900, ce loss: 0.6109, ringloss:0.0935, loss:0.7044, train acc: 0.9531
Loss is:0.5640/0.1024, Train Accuracy is:95.60%, Test Accuracy is:94.36%, {'accuracy': 0.9544, 'epoch': 26}
0.9713, 0.9735, 0.9441, 0.9516, 0.9639, 0.9380, 0.9674, 0.9604, 0.9287, 0.9568
0.9633, 0.9885, 0.9293, 0.9743, 0.9674, 0.8711, 0.9489, 0.9611, 0.8634, 0.9534
Epoch 29/40
----------
6.318741321563721
step: 0, ce loss: 0.6103, ringloss:0.1030, loss:0.7133, train acc: 0.9062
6.328757286071777
step: 100, ce loss: 0.4901, ringloss:0.0719, loss:0.5620, train acc: 0.9688
6.339021682739258
step: 200, ce loss: 0.5499, ringloss:0.0484, loss:0.5984, train acc: 0.9688
6.349042892456055
step: 300, ce loss: 0.5464, ringloss:0.0608, loss:0.6072, train acc: 0.9375
6.358567714691162
step: 400, ce loss: 0.5043, ringloss:0.1248, loss:0.6290, train acc: 0.9844
6.367820739746094
step: 500, ce loss: 0.5140, ringloss:0.0824, loss:0.5964, train acc: 0.9688
6.377777099609375
step: 600, ce loss: 0.5747, ringloss:0.1621, loss:0.7368, train acc: 0.9688
6.386824131011963
step: 700, ce loss: 0.6798, ringloss:0.2582, loss:0.9381, train acc: 0.9375
6.3968119621276855
step: 800, ce loss: 0.6183, ringloss:0.1362, loss:0.7545, train acc: 0.9375
6.406188011169434
step: 900, ce loss: 0.5564, ringloss:0.1408, loss:0.6971, train acc: 0.9375
Loss is:0.5572/0.0974, Train Accuracy is:95.58%, Test Accuracy is:95.47%, {'accuracy': 0.9547, 'epoch': 29}
0.9745, 0.9736, 0.9460, 0.9535, 0.9599, 0.9338, 0.9655, 0.9625, 0.9291, 0.9543
0.9755, 0.9815, 0.9525, 0.9564, 0.9674, 0.9339, 0.9468, 0.9533, 0.9199, 0.9534
Epoch 30/40
----------
6.409642696380615
step: 0, ce loss: 0.4915, ringloss:0.1146, loss:0.6061, train acc: 0.9844
6.419768810272217
step: 100, ce loss: 0.5240, ringloss:0.0747, loss:0.5987, train acc: 0.9531
6.42940616607666
step: 200, ce loss: 0.7012, ringloss:0.2448, loss:0.9460, train acc: 0.9062
6.438183784484863
step: 300, ce loss: 0.5389, ringloss:0.0928, loss:0.6317, train acc: 0.9531
6.447534561157227
step: 400, ce loss: 0.4822, ringloss:0.0627, loss:0.5450, train acc: 0.9688
6.457067489624023
step: 500, ce loss: 0.5134, ringloss:0.1113, loss:0.6247, train acc: 0.9688
6.466541290283203
step: 600, ce loss: 0.5258, ringloss:0.0889, loss:0.6147, train acc: 0.9688
6.475263595581055
step: 700, ce loss: 0.5057, ringloss:0.1046, loss:0.6103, train acc: 0.9531
6.4847235679626465
step: 800, ce loss: 0.5396, ringloss:0.1758, loss:0.7154, train acc: 0.9375
6.49430513381958
step: 900, ce loss: 0.6212, ringloss:0.1806, loss:0.8018, train acc: 0.9375
Loss is:0.5488/0.0996, Train Accuracy is:95.66%, Test Accuracy is:94.99%, {'accuracy': 0.9547, 'epoch': 29}
0.9738, 0.9746, 0.9456, 0.9530, 0.9611, 0.9349, 0.9676, 0.9641, 0.9298, 0.9565
0.9735, 0.9806, 0.9351, 0.9257, 0.9552, 0.9103, 0.9645, 0.9416, 0.9528, 0.9534
Epoch 31/40
----------
6.497716426849365
step: 0, ce loss: 0.7542, ringloss:0.0941, loss:0.8483, train acc: 0.9219
6.507044792175293
step: 100, ce loss: 0.4625, ringloss:0.1577, loss:0.6202, train acc: 1.0000
6.516700744628906
step: 200, ce loss: 0.5366, ringloss:0.0602, loss:0.5968, train acc: 0.9688
6.526144027709961
step: 300, ce loss: 0.5121, ringloss:0.1084, loss:0.6205, train acc: 0.9688
6.535277843475342
step: 400, ce loss: 0.4947, ringloss:0.1025, loss:0.5973, train acc: 0.9844
6.5440521240234375
step: 500, ce loss: 0.5264, ringloss:0.1177, loss:0.6441, train acc: 0.9531
6.552912712097168
step: 600, ce loss: 0.5419, ringloss:0.0901, loss:0.6320, train acc: 0.9219
6.562602996826172
step: 700, ce loss: 0.5365, ringloss:0.1001, loss:0.6366, train acc: 0.9688
6.571891784667969
step: 800, ce loss: 0.5259, ringloss:0.1361, loss:0.6620, train acc: 0.9375
6.581017971038818
step: 900, ce loss: 0.4708, ringloss:0.0404, loss:0.5112, train acc: 1.0000
Loss is:0.5409/0.1007, Train Accuracy is:95.82%, Test Accuracy is:95.23%, {'accuracy': 0.9547, 'epoch': 29}
0.9760, 0.9773, 0.9461, 0.9555, 0.9644, 0.9373, 0.9706, 0.9638, 0.9306, 0.9556
0.9806, 0.9648, 0.9545, 0.9614, 0.9654, 0.9294, 0.9551, 0.9329, 0.9271, 0.9485
Epoch 32/40
----------
6.58431339263916
step: 0, ce loss: 0.4928, ringloss:0.1329, loss:0.6257, train acc: 0.9688
6.593297004699707
step: 100, ce loss: 0.5047, ringloss:0.0647, loss:0.5694, train acc: 0.9531
6.602219104766846
step: 200, ce loss: 0.7444, ringloss:0.1218, loss:0.8662, train acc: 0.9531
6.61129093170166
step: 300, ce loss: 0.5015, ringloss:0.0890, loss:0.5905, train acc: 0.9844
6.620627403259277
step: 400, ce loss: 0.6822, ringloss:0.1068, loss:0.7891, train acc: 0.9375
6.629823684692383
step: 500, ce loss: 0.5860, ringloss:0.2424, loss:0.8284, train acc: 0.9531
6.639433860778809
step: 600, ce loss: 0.5365, ringloss:0.0663, loss:0.6027, train acc: 0.9531
6.648211479187012
step: 700, ce loss: 0.5185, ringloss:0.0819, loss:0.6003, train acc: 0.9219
6.656578063964844
step: 800, ce loss: 0.4858, ringloss:0.0870, loss:0.5729, train acc: 0.9688
6.665078163146973
step: 900, ce loss: 0.4890, ringloss:0.1155, loss:0.6044, train acc: 0.9844
Loss is:0.5364/0.1016, Train Accuracy is:95.74%, Test Accuracy is:95.29%, {'accuracy': 0.9547, 'epoch': 29}
0.9745, 0.9733, 0.9455, 0.9556, 0.9642, 0.9376, 0.9694, 0.9620, 0.9303, 0.9573
0.9765, 0.9903, 0.9283, 0.9743, 0.9440, 0.9283, 0.9614, 0.9416, 0.9168, 0.9604
Epoch 33/40
----------
6.668635845184326
step: 0, ce loss: 0.5328, ringloss:0.0997, loss:0.6325, train acc: 0.9375
6.6781535148620605
step: 100, ce loss: 0.5175, ringloss:0.1213, loss:0.6388, train acc: 0.9688
6.687240123748779
step: 200, ce loss: 0.5849, ringloss:0.0854, loss:0.6703, train acc: 0.9375
6.69642972946167
step: 300, ce loss: 0.5595, ringloss:0.0799, loss:0.6393, train acc: 0.9219
6.705625057220459
step: 400, ce loss: 0.4923, ringloss:0.0802, loss:0.5725, train acc: 0.9844
6.714139938354492
step: 500, ce loss: 0.6787, ringloss:0.0896, loss:0.7683, train acc: 0.9219
6.722391605377197
step: 600, ce loss: 0.5151, ringloss:0.0959, loss:0.6110, train acc: 0.9688
6.730643272399902
step: 700, ce loss: 0.5750, ringloss:0.1333, loss:0.7084, train acc: 0.9531
6.739187717437744
step: 800, ce loss: 0.4828, ringloss:0.0697, loss:0.5525, train acc: 0.9688
6.748143672943115
step: 900, ce loss: 0.5087, ringloss:0.1030, loss:0.6116, train acc: 0.9688
Loss is:0.5292/0.1051, Train Accuracy is:95.84%, Test Accuracy is:95.49%, {'accuracy': 0.9549, 'epoch': 33}
0.9757, 0.9743, 0.9460, 0.9582, 0.9623, 0.9389, 0.9703, 0.9631, 0.9332, 0.9581
0.9704, 0.9833, 0.9554, 0.9703, 0.9369, 0.9361, 0.9489, 0.9591, 0.9199, 0.9613
Epoch 34/40
----------
6.7511677742004395
step: 0, ce loss: 0.5257, ringloss:0.0642, loss:0.5899, train acc: 0.9688
6.75982141494751
step: 100, ce loss: 0.4900, ringloss:0.0781, loss:0.5681, train acc: 0.9844
6.767661094665527
step: 200, ce loss: 0.4903, ringloss:0.0618, loss:0.5521, train acc: 0.9531
6.776267051696777
step: 300, ce loss: 0.4826, ringloss:0.1099, loss:0.5925, train acc: 0.9688
6.785127639770508
step: 400, ce loss: 0.5715, ringloss:0.1004, loss:0.6719, train acc: 0.9375
6.793388366699219
step: 500, ce loss: 0.5167, ringloss:0.0697, loss:0.5864, train acc: 0.9375
6.801702499389648
step: 600, ce loss: 0.5451, ringloss:0.0875, loss:0.6326, train acc: 0.9531
6.80974817276001
step: 700, ce loss: 0.4752, ringloss:0.0969, loss:0.5722, train acc: 0.9688
6.818259239196777
step: 800, ce loss: 0.4827, ringloss:0.1235, loss:0.6063, train acc: 0.9844
6.826517581939697
step: 900, ce loss: 0.4609, ringloss:0.0813, loss:0.5422, train acc: 0.9844
Loss is:0.5228/0.1027, Train Accuracy is:95.94%, Test Accuracy is:95.54%, {'accuracy': 0.9554, 'epoch': 34}
0.9787, 0.9754, 0.9483, 0.9553, 0.9642, 0.9389, 0.9704, 0.9636, 0.9378, 0.9568
0.9735, 0.9841, 0.9583, 0.9663, 0.9389, 0.9484, 0.9666, 0.9407, 0.9209, 0.9514
Epoch 35/40
----------
6.829239845275879
step: 0, ce loss: 0.4929, ringloss:0.1175, loss:0.6104, train acc: 0.9688
6.837242603302002
step: 100, ce loss: 0.5681, ringloss:0.1423, loss:0.7104, train acc: 0.9531
6.845123291015625
step: 200, ce loss: 0.5239, ringloss:0.0703, loss:0.5942, train acc: 0.9062
6.853543758392334
step: 300, ce loss: 0.4821, ringloss:0.1708, loss:0.6529, train acc: 1.0000
6.861698627471924
step: 400, ce loss: 0.5355, ringloss:0.2471, loss:0.7827, train acc: 0.9531
6.870318412780762
step: 500, ce loss: 0.4841, ringloss:0.0810, loss:0.5651, train acc: 0.9688
6.878446102142334
step: 600, ce loss: 0.4999, ringloss:0.1151, loss:0.6150, train acc: 0.9531
6.885676860809326
step: 700, ce loss: 0.5092, ringloss:0.1116, loss:0.6208, train acc: 0.9844
6.894086837768555
step: 800, ce loss: 0.5483, ringloss:0.1545, loss:0.7028, train acc: 0.9375
6.902698516845703
step: 900, ce loss: 0.4546, ringloss:0.0764, loss:0.5310, train acc: 0.9844
Loss is:0.5172/0.1020, Train Accuracy is:95.97%, Test Accuracy is:95.15%, {'accuracy': 0.9554, 'epoch': 34}
0.9769, 0.9767, 0.9486, 0.9566, 0.9618, 0.9436, 0.9718, 0.9649, 0.9349, 0.9570
0.9765, 0.9833, 0.9593, 0.9703, 0.9654, 0.9204, 0.9562, 0.9514, 0.8871, 0.9366
Epoch 36/40
----------
6.905947208404541
step: 0, ce loss: 0.4917, ringloss:0.0997, loss:0.5914, train acc: 0.9688
6.914541244506836
step: 100, ce loss: 0.4875, ringloss:0.0700, loss:0.5574, train acc: 0.9844
6.922565460205078
step: 200, ce loss: 0.4684, ringloss:0.0806, loss:0.5489, train acc: 1.0000
6.930232524871826
step: 300, ce loss: 0.5720, ringloss:0.1100, loss:0.6820, train acc: 0.9375
6.939031600952148
step: 400, ce loss: 0.4777, ringloss:0.1617, loss:0.6394, train acc: 0.9531
6.94705057144165
step: 500, ce loss: 0.4741, ringloss:0.0919, loss:0.5660, train acc: 0.9688
6.954595565795898
step: 600, ce loss: 0.6743, ringloss:0.1466, loss:0.8209, train acc: 0.9375
6.962267875671387
step: 700, ce loss: 0.5243, ringloss:0.1675, loss:0.6918, train acc: 0.9219
6.969871997833252
step: 800, ce loss: 0.4784, ringloss:0.0610, loss:0.5394, train acc: 0.9688
6.977578639984131
step: 900, ce loss: 0.5003, ringloss:0.1674, loss:0.6676, train acc: 0.9688
Loss is:0.5116/0.1043, Train Accuracy is:95.96%, Test Accuracy is:95.70%, {'accuracy': 0.957, 'epoch': 36}
0.9755, 0.9766, 0.9491, 0.9560, 0.9653, 0.9367, 0.9728, 0.9652, 0.9356, 0.9585
0.9745, 0.9806, 0.9516, 0.9475, 0.9644, 0.9238, 0.9614, 0.9591, 0.9528, 0.9485
Epoch 37/40
----------
6.980340480804443
step: 0, ce loss: 0.5140, ringloss:0.0666, loss:0.5806, train acc: 0.9531
6.987934589385986
step: 100, ce loss: 0.5389, ringloss:0.1126, loss:0.6515, train acc: 0.8906
6.996328830718994
step: 200, ce loss: 0.6894, ringloss:0.0794, loss:0.7688, train acc: 0.9688
7.004586696624756
step: 300, ce loss: 0.4824, ringloss:0.1068, loss:0.5892, train acc: 0.9531
7.012731075286865
step: 400, ce loss: 0.5727, ringloss:0.1178, loss:0.6905, train acc: 0.9219
7.020394802093506
step: 500, ce loss: 0.4918, ringloss:0.1095, loss:0.6013, train acc: 0.9688
7.0280938148498535
step: 600, ce loss: 0.4362, ringloss:0.1042, loss:0.5404, train acc: 0.9844
7.035821914672852
step: 700, ce loss: 0.5927, ringloss:0.1259, loss:0.7186, train acc: 0.9219
7.043893337249756
step: 800, ce loss: 0.4964, ringloss:0.0622, loss:0.5586, train acc: 0.9531
7.0518317222595215
step: 900, ce loss: 0.5152, ringloss:0.0900, loss:0.6052, train acc: 0.9531
Loss is:0.5064/0.1042, Train Accuracy is:95.97%, Test Accuracy is:95.85%, {'accuracy': 0.9585, 'epoch': 37}
0.9779, 0.9758, 0.9498, 0.9561, 0.9642, 0.9408, 0.9714, 0.9655, 0.9316, 0.9592
0.9663, 0.9841, 0.9486, 0.9366, 0.9664, 0.9585, 0.9562, 0.9553, 0.9528, 0.9574
Epoch 38/40
----------
7.055251121520996
step: 0, ce loss: 0.4677, ringloss:0.0814, loss:0.5490, train acc: 0.9531
7.062966346740723
step: 100, ce loss: 0.4827, ringloss:0.0789, loss:0.5616, train acc: 0.9688
7.070783615112305
step: 200, ce loss: 0.4542, ringloss:0.1322, loss:0.5864, train acc: 0.9688
7.079197883605957
step: 300, ce loss: 0.6293, ringloss:0.1702, loss:0.7994, train acc: 0.9062
7.086309909820557
step: 400, ce loss: 0.5180, ringloss:0.1637, loss:0.6817, train acc: 0.9062
7.094088077545166
step: 500, ce loss: 0.4905, ringloss:0.1821, loss:0.6726, train acc: 0.9531
7.102081298828125
step: 600, ce loss: 0.4874, ringloss:0.1070, loss:0.5944, train acc: 0.9531
7.109772682189941
step: 700, ce loss: 0.4774, ringloss:0.0495, loss:0.5269, train acc: 0.9531
7.11747932434082
step: 800, ce loss: 0.5258, ringloss:0.0810, loss:0.6067, train acc: 0.9062
7.125185966491699
step: 900, ce loss: 0.4908, ringloss:0.1213, loss:0.6121, train acc: 0.9688
Loss is:0.5002/0.1038, Train Accuracy is:95.97%, Test Accuracy is:95.48%, {'accuracy': 0.9585, 'epoch': 37}
0.9775, 0.9769, 0.9515, 0.9556, 0.9622, 0.9380, 0.9694, 0.9658, 0.9345, 0.9613
0.9837, 0.9833, 0.9438, 0.9772, 0.9745, 0.9182, 0.9489, 0.9514, 0.9076, 0.9514
Epoch 39/40
----------
7.127867698669434
step: 0, ce loss: 0.5684, ringloss:0.1787, loss:0.7471, train acc: 0.9062
7.1355438232421875
step: 100, ce loss: 0.6050, ringloss:0.1182, loss:0.7233, train acc: 0.9531
7.143158912658691
step: 200, ce loss: 0.6126, ringloss:0.1267, loss:0.7393, train acc: 0.9375
7.15104341506958
step: 300, ce loss: 0.5363, ringloss:0.1494, loss:0.6858, train acc: 0.9375
7.1586151123046875
step: 400, ce loss: 0.4532, ringloss:0.0809, loss:0.5341, train acc: 0.9688
7.166780948638916
step: 500, ce loss: 0.4639, ringloss:0.0926, loss:0.5566, train acc: 0.9688
7.174886226654053
step: 600, ce loss: 0.5100, ringloss:0.2277, loss:0.7377, train acc: 0.9531
7.182497501373291
step: 700, ce loss: 0.4315, ringloss:0.0954, loss:0.5269, train acc: 1.0000
7.190687656402588
step: 800, ce loss: 0.4703, ringloss:0.0865, loss:0.5568, train acc: 0.9844
7.19891881942749
step: 900, ce loss: 0.4420, ringloss:0.0767, loss:0.5187, train acc: 1.0000
Loss is:0.4952/0.1009, Train Accuracy is:96.09%, Test Accuracy is:95.49%, {'accuracy': 0.9585, 'epoch': 37}
0.9779, 0.9786, 0.9515, 0.9573, 0.9671, 0.9441, 0.9701, 0.9655, 0.9320, 0.9612
0.9816, 0.9824, 0.9574, 0.9485, 0.9613, 0.9316, 0.9666, 0.9377, 0.9240, 0.9524
Epoch 40/40
----------
7.2017693519592285
step: 0, ce loss: 0.4409, ringloss:0.0831, loss:0.5239, train acc: 1.0000
7.2097673416137695
step: 100, ce loss: 0.6063, ringloss:0.1050, loss:0.7113, train acc: 0.9688
7.217352390289307
step: 200, ce loss: 0.4359, ringloss:0.0795, loss:0.5154, train acc: 0.9688
7.224969863891602
step: 300, ce loss: 0.4659, ringloss:0.0679, loss:0.5338, train acc: 0.9531
7.233119964599609
step: 400, ce loss: 0.4620, ringloss:0.1298, loss:0.5918, train acc: 0.9688
7.240798473358154
step: 500, ce loss: 0.5513, ringloss:0.1064, loss:0.6577, train acc: 0.9375
7.247442245483398
step: 600, ce loss: 0.5015, ringloss:0.0716, loss:0.5730, train acc: 0.9375
7.254796981811523
step: 700, ce loss: 0.4586, ringloss:0.0925, loss:0.5511, train acc: 0.9375
7.262099742889404
step: 800, ce loss: 0.4571, ringloss:0.0733, loss:0.5304, train acc: 0.9844
7.269411087036133
step: 900, ce loss: 0.4305, ringloss:0.0641, loss:0.4946, train acc: 1.0000
Loss is:0.4908/0.1057, Train Accuracy is:96.16%, Test Accuracy is:95.66%, {'accuracy': 0.9585, 'epoch': 37}
0.9775, 0.9761, 0.9545, 0.9586, 0.9678, 0.9413, 0.9733, 0.9682, 0.9369, 0.9570
0.9857, 0.9868, 0.9409, 0.9426, 0.9644, 0.9339, 0.9614, 0.9591, 0.9384, 0.9475
Finish training!
The best accuracy model is: {'accuracy': 0.9585, 'epoch': 37}
weight_norm: tensor([0.3518, 0.2842, 0.3658, 0.2845, 0.2939, 0.4082, 0.3694, 0.2912, 0.3191,
        0.2515])
Could not load matplotlib icon: can't use "pyimage10" as iconphoto: not a photo image
